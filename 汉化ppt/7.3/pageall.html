<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head> <body onload="start()"><div style="background:#5c5c5f; color:#FFF"> <p align="center">&#x5FAE;&#x4FE1;&#x516C;&#x4F17;&#x53F7;[&#x6DF1;&#x5BB9;Pubmed&#x6587;&#x732E;&#x68C0;&#x7D22;] &nbsp 1. &#x6B64;&#x5904;&#x53F3;&#x952E;&#xFF1A;&#x9009;&#x83DC;&#x5355;&#x3010;&#x7FFB;&#x6210;&#x4E2D;&#x6587;&#xFF08;&#x7B80;&#x4F53;&#xFF09;&#x3011; &nbsp &nbsp &nbsp  2. &#x7FFB;&#x8BD1;&#x540E;&#xFF0C;&#x6B64;&#x5904;&#x53F3;&#x952E;&#xFF1A;&#x9009;&#x83DC;&#x5355;&#x3010;&#x6253;&#x5370;...&#x3011;&#x6210;PDF&#x683C;&#x5F0F; <br>&#x5EFA;&#x8BAE;&#x5C4F;&#x5E55;&#x5206;&#x8FA8;&#x7387;&#xFF1A;1920X1080&#xFF1B;&#x5982;&#x679C;&#x5C4F;&#x5E55;&#x592A;&#x5C0F;&#xFF0C;&#x53EF;&#x4EE5;&#x6309;Ctrl + &#x6216; Ctrl -&#x7F29;&#x653E;&#x7F51;&#x9875;&#x3002;</p></div><style type="text/css"> .txt { white-space:nowrap; }	 #f0 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f1 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f2 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f3 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f4 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f5 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f6 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f7 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f8 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f9 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f10 { font-family:sans-serif; font-weight:normal; font-style:normal; }  #f11 { font-family:sans-serif; font-weight:normal; font-style:normal; }  #f12 { font-family:sans-serif; font-weight:normal; font-style:normal; } 	#f13 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f14 { font-family:sans-serif; font-weight:normal; font-style:normal; } #f15 { font-family:sans-serif; font-weight:normal; font-style:normal; } 	#f16 { font-family:sans-serif; font-weight:normal; font-style:normal; }	 #f17 { font-family:sans-serif; font-weight:normal; font-style:normal; } #f18 { font-family:sans-serif; font-weight:normal; font-style:normal; } #f19 { font-family:sans-serif; font-weight:normal; font-style:normal; }		#f20 { font-family:sans-serif; font-weight:normal; font-style:normal; }		</style><img id="background" style="position:absolute; left:0px; top:50px;" width="1440" height="1080" src="page1.png"> <img id="background" style="position:absolute; left:1440px; top:50px;" width="1440" height="1080" src="page-000001.png">
<div class="txt" style="position:absolute; left:1105px; top:68px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:263px; top:275px;"><span id="f9" style="font-size:55px;vertical-align:baseline;color:rgba(0,0,0,1);">Chapter 7: Software Construction for</span></div>
<div class="txt" style="position:absolute; left:579px; top:342px;"><span id="f9" style="font-size:55px;vertical-align:baseline;color:rgba(0,0,0,1);">Robustness</span></div>
<div class="txt" style="position:absolute; left:243px; top:413px;"><span id="f17" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive</span></div>
<div class="txt" style="position:absolute; left:493px; top:500px;"><span id="f17" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">Programming</span></div>
<div class="txt" style="position:absolute; left:596px; top:719px;"><span id="f9" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Xu Hanchuan</span></div>
<div class="txt" style="position:absolute; left:585px; top:772px;"><span id="f9" style="font-size:40px;vertical-align:baseline;color:rgba(255,98,176,1);">xhc@hit.edu.cn</span></div>
<div class="txt" style="position:absolute; left:614px; top:877px;"><span id="f9" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">May 6, 2019</span></div>
<img id="background" style="position:absolute; left:0px; top:1050px;" width="1440" height="1080" src="page2.png"> <img id="background" style="position:absolute; left:1440px; top:1050px;" width="1440" height="1080" src="page-000002.png">
<div class="txt" style="position:absolute; left:33px; top:1157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Outline</span></div>
<div class="txt" style="position:absolute; left:804px; top:1068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:1297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Recall: Designing an ADT</span></div>
<div class="txt" style="position:absolute; left:76px; top:1369px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions</span></div>
<div class="txt" style="position:absolute; left:112px; top:1436px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">What to Assert and What not to?</span></div>
<div class="txt" style="position:absolute; left:112px; top:1496px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Guidelines for Using Assertions</span></div>
<div class="txt" style="position:absolute; left:76px; top:1562px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:112px; top:1629px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Techniques for defensive programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:1694px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Summary</span></div>
<img id="background" style="position:absolute; left:0px; top:2050px;" width="1440" height="1080" src="page3.png"> <img id="background" style="position:absolute; left:1440px; top:2050px;" width="1440" height="1080" src="page-000003.png">
<div class="txt" style="position:absolute; left:1105px; top:2068px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:280px; top:2465px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">1 Recall: Designing an ADT</span></div>
<img id="background" style="position:absolute; left:0px; top:3050px;" width="1440" height="1080" src="page4.png"> <img id="background" style="position:absolute; left:1440px; top:3050px;" width="1440" height="1080" src="page-000004.png">
<div class="txt" style="position:absolute; left:804px; top:3068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:3157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">First Defense: Make Bugs Impossible</span></div>
<div class="txt" style="position:absolute; left:76px; top:3297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The best defense against bugs is to make them impossible by</span></div>
<div class="txt" style="position:absolute; left:112px; top:3347px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">design.</span></div>
<div class="txt" style="position:absolute; left:112px; top:3412px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Static checking</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: eliminates many bugs by catching them at compile time.</span></div>
<div class="txt" style="position:absolute; left:112px; top:3472px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Dynamic checking</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: Java makes array overflow bugs impossible by catching</span></div>
<div class="txt" style="position:absolute; left:148px; top:3515px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">them dynamically. If you try to use an index outside the bounds of an array</span></div>
<div class="txt" style="position:absolute; left:148px; top:3559px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">or a List, then Java automatically produces an error.</span></div>
<div class="txt" style="position:absolute; left:112px; top:3619px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Immutability </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">(immunity from change): An immutable type is a type whose</span></div>
<div class="txt" style="position:absolute; left:148px; top:3662px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">values can never change once they have been created.</span></div>
<div class="txt" style="position:absolute; left:112px; top:3723px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Defensive copying</span></div>
<div class="txt" style="position:absolute; left:112px; top:3783px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Immutable references</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: by </span><span id="f34" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">final</span></div>
<img id="background" style="position:absolute; left:0px; top:4050px;" width="1440" height="1080" src="page5.png"> <img id="background" style="position:absolute; left:1440px; top:4050px;" width="1440" height="1080" src="page-000005.png">
<div class="txt" style="position:absolute; left:804px; top:4068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:4157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Second Defense: Localize Bugs</span></div>
<div class="txt" style="position:absolute; left:76px; top:4297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If we can’t prevent bugs, we can try to localize them to a small part</span></div>
<div class="txt" style="position:absolute; left:112px; top:4347px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">of the program, so that we don’t have to look too hard to find the</span></div>
<div class="txt" style="position:absolute; left:112px; top:4390px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">cause of a bug. </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">如果</span><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">bug</span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不能被阻止，则限制在尽可能小的范围内</span></div>
<div class="txt" style="position:absolute; left:76px; top:4465px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">When localized to a single method or small module, bugs may be</span></div>
<div class="txt" style="position:absolute; left:112px; top:4515px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">found simply by studying the program text.</span></div>
<div class="txt" style="position:absolute; left:76px; top:4585px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Fail fast</span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">: the earlier a problem is observed (the closer to its cause),</span></div>
<div class="txt" style="position:absolute; left:112px; top:4630px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">the easier it is to fix. </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">问题越早被发现</span><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">离起因越近</span><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">)</span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">，越容易修复</span></div>
<img id="background" style="position:absolute; left:0px; top:5050px;" width="1440" height="1080" src="page6.png"> <img id="background" style="position:absolute; left:1440px; top:5050px;" width="1440" height="1080" src="page-000006.png">
<div class="txt" style="position:absolute; left:804px; top:5068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:5157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Second Defense: Localize Bugs</span></div>
<div class="txt" style="position:absolute; left:76px; top:5297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Assertions: </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">When the precondition is not satisfied, this code</span></div>
<div class="txt" style="position:absolute; left:112px; top:5346px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">terminates the program by throwing an </span><span id="f17" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">AssertionError</span></div>
<div class="txt" style="position:absolute; left:112px; top:5395px;"><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">exception. The effects of the caller’s bug are prevented from</span></div>
<div class="txt" style="position:absolute; left:112px; top:5438px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">propagating. </span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">利用</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">assertion</span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">检查前置条件的满足性</span></div>
<div class="txt" style="position:absolute; left:76px; top:5585px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Checking preconditions is an example of </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">defensive programming.</span></div>
<div class="txt" style="position:absolute; left:112px; top:5635px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Real programs are rarely bug-free. Defensive programming offers a</span></div>
<div class="txt" style="position:absolute; left:112px; top:5683px;"><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">way to mitigate the effects of bugs even if you don’t know where</span></div>
<div class="txt" style="position:absolute; left:112px; top:5726px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">they are. </span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">检查前置条件是防御性编程的一种方式</span></div>
<img id="background" style="position:absolute; left:0px; top:6050px;" width="1440" height="1080" src="page7.png"> <img id="background" style="position:absolute; left:1440px; top:6050px;" width="1440" height="1080" src="page-000007.png">
<div class="txt" style="position:absolute; left:1105px; top:6068px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:524px; top:6465px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">2 Assertions</span></div>
<img id="background" style="position:absolute; left:0px; top:7050px;" width="1440" height="1080" src="page8.png"> <img id="background" style="position:absolute; left:1440px; top:7050px;" width="1440" height="1080" src="page-000008.png">
<div class="txt" style="position:absolute; left:1105px; top:7068px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:233px; top:7465px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">(1) What and Why Assertions?</span></div>
<img id="background" style="position:absolute; left:0px; top:8050px;" width="1440" height="1080" src="page9.png"> <img id="background" style="position:absolute; left:1440px; top:8050px;" width="1440" height="1080" src="page-000009.png">
<div class="txt" style="position:absolute; left:33px; top:8157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What is assertion?</span></div>
<div class="txt" style="position:absolute; left:804px; top:8068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:8297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">An assertion is code that’s used during development that allows a</span></div>
<div class="txt" style="position:absolute; left:112px; top:8346px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">program to check itself as it runs, i.e., </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">to </span><span id="f18" style="font-size:37px;vertical-align:baseline;color:rgba(255,0,0,1);">test your assumptions </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">about</span></div>
<div class="txt" style="position:absolute; left:112px; top:8395px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">your program logic (such as pre-conditions, post-conditions, and</span></div>
<div class="txt" style="position:absolute; left:112px; top:8438px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">invariants). </span><span id="f28" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">断言用于在运行时检查代码正确性</span></div>
<div class="txt" style="position:absolute; left:112px; top:8508px;"><span id="f30" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">When an assertion is true, that means everything is operating as expected.</span></div>
<div class="txt" style="position:absolute; left:112px; top:8568px;"><span id="f30" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f34" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">When it’s false, that means it has detected an unexpected error in the code.</span></div>
<div class="txt" style="position:absolute; left:76px; top:8634px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">An example</span></div>
<div class="txt" style="position:absolute; left:178px; top:8702px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">public class AssertionTest {</span></div>
<div class="txt" style="position:absolute; left:234px; top:8743px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">public static void main(String[] args) {</span></div>
<div class="txt" style="position:absolute; left:291px; top:8783px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">int number = -5; // assumed number is not negative</span></div>
<div class="txt" style="position:absolute; left:291px; top:8824px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">// This assert also serve as documentation</span></div>
<div class="txt" style="position:absolute; left:291px; top:8865px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">assert (number &gt;= 0) : "number is negative: " + number;</span></div>
<div class="txt" style="position:absolute; left:291px; top:8906px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">// do something</span></div>
<div class="txt" style="position:absolute; left:291px; top:8947px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">System.out.println("The number is " + number);</span></div>
<div class="txt" style="position:absolute; left:234px; top:8987px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<div class="txt" style="position:absolute; left:178px; top:9028px;"><span id="f38" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<img id="background" style="position:absolute; left:0px; top:9050px;" width="1440" height="1080" src="page10.png"> <img id="background" style="position:absolute; left:1440px; top:9050px;" width="1440" height="1080" src="page-000010.png">
<div class="txt" style="position:absolute; left:33px; top:9157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What is assertion?</span></div>
<div class="txt" style="position:absolute; left:804px; top:9068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:9297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Each assertion contains a </span><span id="f15" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">boolean </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">expression that you believe will</span></div>
<div class="txt" style="position:absolute; left:112px; top:9347px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">be true when the program executes.</span></div>
<div class="txt" style="position:absolute; left:76px; top:9417px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If it is not true, the JVM will throw an </span><span id="f15" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">AssertionError</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">.</span></div>
<div class="txt" style="position:absolute; left:76px; top:9489px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">This error signals you that you have an invalid assumption that</span></div>
<div class="txt" style="position:absolute; left:112px; top:9539px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">needs to be fixed.</span></div>
<div class="txt" style="position:absolute; left:76px; top:9609px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Assertion is much better than using </span><span id="f28" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">if-else </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">statements, as it</span></div>
<div class="txt" style="position:absolute; left:112px; top:9659px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">serves as proper documentation on your assumptions, and it does</span></div>
<div class="txt" style="position:absolute; left:112px; top:9702px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">not carry performance liability in the production environment. </span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">断</span></div>
<div class="txt" style="position:absolute; left:112px; top:9750px;"><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">言要优于</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">if-else</span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">语句：</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">1.</span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">对程序中的假设起到适当的文档作用；</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">2.</span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">在实</span></div>
<div class="txt" style="position:absolute; left:112px; top:9798px;"><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">际运行时不会带来性能问题</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">在实现运行时断言可被禁止</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">)</span><span id="f36" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">。</span></div>
<img id="background" style="position:absolute; left:0px; top:10050px;" width="1440" height="1080" src="page11.png"> <img id="background" style="position:absolute; left:1440px; top:10050px;" width="1440" height="1080" src="page-000011.png">
<div class="txt" style="position:absolute; left:33px; top:10157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What is assertion?</span></div>
<div class="txt" style="position:absolute; left:804px; top:10068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:10297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">An assertion usually takes </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">two arguments</span></div>
<div class="txt" style="position:absolute; left:112px; top:10364px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">a boolean expression </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">that describes the assumption supposed to be true</span></div>
<div class="txt" style="position:absolute; left:112px; top:10424px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">a message </span><span id="f24" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">to display if it isn’t.</span></div>
<div class="txt" style="position:absolute; left:76px; top:10490px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The Java language has a keyword </span><span id="f28" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">assert</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">. There are two forms:</span></div>
<div class="txt" style="position:absolute; left:112px; top:10557px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f32" style="font-size:15px;vertical-align:baseline;color:rgba(255,0,0,1);">assert condition;</span></div>
<div class="txt" style="position:absolute; left:112px; top:10617px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f32" style="font-size:15px;vertical-align:baseline;color:rgba(255,0,0,1);">assert condition : expression;</span></div>
<div class="txt" style="position:absolute; left:112px; top:10677px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Both statements evaluate the condition and throw an </span><span id="f32" style="font-size:15px;vertical-align:baseline;color:rgba(255,0,0,1);">AssertionError </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">if</span></div>
<div class="txt" style="position:absolute; left:148px; top:10721px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the boolean expression evaluates to false.</span></div>
<div class="txt" style="position:absolute; left:112px; top:10781px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">In the second statement, the expression is passed to the constructor of the</span></div>
<div class="txt" style="position:absolute; left:148px; top:10824px;"><span id="f32" style="font-size:15px;vertical-align:baseline;color:rgba(255,0,0,1);">AssertionError </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">object and turned into a message string. The description</span></div>
<div class="txt" style="position:absolute; left:148px; top:10868px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">is printed in an error message when the assertion fails, so it can be used to</span></div>
<div class="txt" style="position:absolute; left:148px; top:10911px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">provide additional details to the programmer about the cause of the</span></div>
<div class="txt" style="position:absolute; left:148px; top:10950px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">failure. </span><span id="f51" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">第二种方式允许提供错误信息提示</span></div>
<img id="background" style="position:absolute; left:0px; top:11050px;" width="1440" height="1080" src="page12.png"> <img id="background" style="position:absolute; left:1440px; top:11050px;" width="1440" height="1080" src="page-000012.png">
<div class="txt" style="position:absolute; left:33px; top:11157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertion in Java</span></div>
<div class="txt" style="position:absolute; left:804px; top:11068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:65px; top:11286px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">To assert that </span><span id="f14" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">x </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">is non-negative, you can simply use the statement</span></div>
<div class="txt" style="position:absolute; left:605px; top:11352px;"><span id="f14" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">assert x &gt;= 0;</span></div>
<div class="txt" style="position:absolute; left:65px; top:11479px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Or pass the actual value of </span><span id="f14" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">x </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">into the </span><span id="f14" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">AssertionError </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">object, so that it</span></div>
<div class="txt" style="position:absolute; left:101px; top:11528px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">gets displayed later:</span></div>
<div class="txt" style="position:absolute; left:449px; top:11598px;"><span id="f27" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">assert x &gt;= 0 : “x is ” + x;</span></div>
<div class="txt" style="position:absolute; left:65px; top:11728px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If </span><span id="f14" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">x == -1</span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">, then this assertion fails with the error message</span></div>
<div class="txt" style="position:absolute; left:656px; top:11799px;"><span id="f14" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">x is -1</span></div>
<div class="txt" style="position:absolute; left:65px; top:11865px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">This information is often enough to get started in finding the bug.</span></div>
<img id="background" style="position:absolute; left:0px; top:12050px;" width="1440" height="1080" src="page13.png"> <img id="background" style="position:absolute; left:1440px; top:12050px;" width="1440" height="1080" src="page-000013.png">
<div class="txt" style="position:absolute; left:33px; top:12157px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertion Example</span></div>
<div class="txt" style="position:absolute; left:804px; top:12068px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:65px; top:12286px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">public class AssertionSwitchTest {</span></div>
<div class="txt" style="position:absolute; left:124px; top:12329px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">public static void main(String[] args) {</span></div>
<div class="txt" style="position:absolute; left:183px; top:12373px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">// assumed either '+', '-', '*', '/' only</span></div>
<div class="txt" style="position:absolute; left:183px; top:12416px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">char operator = '%';</span></div>
<div class="txt" style="position:absolute; left:183px; top:12459px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">int operand1 = 5, operand2 = 6, result = 0;</span></div>
<div class="txt" style="position:absolute; left:183px; top:12502px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">switch (operator) {</span></div>
<div class="txt" style="position:absolute; left:242px; top:12546px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">case '+': result = operand1 + operand2; break;</span></div>
<div class="txt" style="position:absolute; left:242px; top:12589px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">case '-': result = operand1 - operand2; break;</span></div>
<div class="txt" style="position:absolute; left:242px; top:12632px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">case '*': result = operand1 * operand2; break;</span></div>
<div class="txt" style="position:absolute; left:242px; top:12675px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">case '/': result = operand1 / operand2; break;</span></div>
<div class="txt" style="position:absolute; left:242px; top:12718px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">default: </span><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(255,0,0,1);">assert false : "Unknown operator: " + operator;</span></div>
<div class="txt" style="position:absolute; left:183px; top:12762px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<div class="txt" style="position:absolute; left:183px; top:12805px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">System.out.println(operand1 + " " + operator + " "</span></div>
<div class="txt" style="position:absolute; left:353px; top:12848px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">+ operand2 + " = " + result);</span></div>
<div class="txt" style="position:absolute; left:124px; top:12891px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<div class="txt" style="position:absolute; left:65px; top:12934px;"><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<div class="txt" style="position:absolute; left:65px; top:12978px;"><span id="f41" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">Result</span><span id="f11" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,0,1);">:</span></div>
<div class="txt" style="position:absolute; left:65px; top:13020px;"><span id="f11" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">Exception in thread "main" java.lang.AssertionError: Unknown operator: %</span></div>
<div class="txt" style="position:absolute; left:65px; top:13059px;"><span id="f11" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">at ch7.assertion.AssertionSwitchTest.main(AssertionSwitchTest.java:13)</span></div>
<img id="background" style="position:absolute; left:0px; top:15507px;" width="1440" height="1080" src="page14.png"> <img id="background" style="position:absolute; left:1440px; top:15507px;" width="1440" height="1080" src="page-000014.png">
<div class="txt" style="position:absolute; left:33px; top:15614px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Why use assertions?</span></div>
<div class="txt" style="position:absolute; left:804px; top:15525px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:15751px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Document &amp; test programmer‘s assumptions</span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">, e.g., invariants; </span><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">测试</span></div>
<div class="txt" style="position:absolute; left:112px; top:15799px;"><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不变性是否保持，同时起到了文档说明作用</span></div>
<div class="txt" style="position:absolute; left:76px; top:15874px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Verify programmer’s understanding</span></div>
<div class="txt" style="position:absolute; left:76px; top:15943px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Quickly uncover bugs </span><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">快速发现</span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">bugs</span></div>
<div class="txt" style="position:absolute; left:76px; top:16018px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Increase confidence that program is bug-free</span></div>
<div class="txt" style="position:absolute; left:76px; top:16090px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Asserts turn black box tests into white box tests</span></div>
<img id="background" style="position:absolute; left:0px; top:16696px;" width="1440" height="1080" src="page15.png"> <img id="background" style="position:absolute; left:1440px; top:16696px;" width="1440" height="1080" src="page-000015.png">
<div class="txt" style="position:absolute; left:33px; top:16803px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Why use assertions?</span></div>
<div class="txt" style="position:absolute; left:804px; top:16714px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:16943px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertion can be used for verifying:</span></div>
<div class="txt" style="position:absolute; left:112px; top:17010px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Internal Invariants</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: Assert that a value is within a certain constraint, e.g.,</span></div>
<div class="txt" style="position:absolute; left:148px; top:17053px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">assert x &gt; 0.</span></div>
<div class="txt" style="position:absolute; left:112px; top:17113px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Class Invariants</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: Assert that an object's state is within a constraint. What</span></div>
<div class="txt" style="position:absolute; left:148px; top:17157px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">must be true about each instance of a class before or after the execution of</span></div>
<div class="txt" style="position:absolute; left:148px; top:17200px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">a method? Class invariants are typically verified via private boolean</span></div>
<div class="txt" style="position:absolute; left:148px; top:17243px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">method, </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">e.g., an checkRep() method to check if a Circle object has a</span></div>
<div class="txt" style="position:absolute; left:148px; top:17287px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">positive radius.</span></div>
<div class="txt" style="position:absolute; left:112px; top:17347px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Control-Flow Invariants</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: Assert that a certain location will not be reached.</span></div>
<div class="txt" style="position:absolute; left:148px; top:17390px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">For example, the default clause of a switch-case statement.</span></div>
<div class="txt" style="position:absolute; left:112px; top:17450px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Pre-conditions of methods</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: What must be true when a method is</span></div>
<div class="txt" style="position:absolute; left:148px; top:17494px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">invoked? Typically expressed in terms of the method's arguments or the</span></div>
<div class="txt" style="position:absolute; left:148px; top:17537px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">states of its objects.</span></div>
<div class="txt" style="position:absolute; left:112px; top:17597px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Post-conditions of methods</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">: What must be true after a method completes</span></div>
<div class="txt" style="position:absolute; left:148px; top:17641px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">successfully?</span></div>
<img id="background" style="position:absolute; left:0px; top:17885px;" width="1440" height="1080" src="page16.png"> <img id="background" style="position:absolute; left:1440px; top:17885px;" width="1440" height="1080" src="page-000016.png">
<div class="txt" style="position:absolute; left:1105px; top:17903px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:147px; top:18300px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">(2) What to Assert and What not to?</span></div>
<img id="background" style="position:absolute; left:0px; top:19074px;" width="1440" height="1080" src="page17.png"> <img id="background" style="position:absolute; left:1440px; top:19074px;" width="1440" height="1080" src="page-000017.png">
<div class="txt" style="position:absolute; left:33px; top:19176px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What to Assert</span><span id="f11" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">？</span></div>
<div class="txt" style="position:absolute; left:804px; top:19092px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:19321px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Method argument requirements</span></div>
<div class="txt" style="position:absolute; left:76px; top:19393px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Method return value requirements</span></div>
<div class="txt" style="position:absolute; left:112px; top:19459px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">This kind of assertion is sometimes called a </span><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">self check </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">.</span></div>
<div class="txt" style="position:absolute; left:215px; top:19506px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">public double sqrt(double x) {</span></div>
<div class="txt" style="position:absolute; left:300px; top:19547px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">assert x &gt;= 0;</span></div>
<div class="txt" style="position:absolute; left:300px; top:19588px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">double r;</span></div>
<div class="txt" style="position:absolute; left:300px; top:19629px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">... // compute result r</span></div>
<div class="txt" style="position:absolute; left:300px; top:19669px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">assert Math.abs(r*r - x) &lt; .0001;</span></div>
<div class="txt" style="position:absolute; left:300px; top:19710px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">return r;</span></div>
<div class="txt" style="position:absolute; left:215px; top:19751px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<div class="txt" style="position:absolute; left:76px; top:19813px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Covering all</span></div>
<div class="txt" style="position:absolute; left:112px; top:19880px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If a conditional statement or switch does not</span></div>
<div class="txt" style="position:absolute; left:148px; top:19923px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">cover all the possible cases, it is good practice</span></div>
<div class="txt" style="position:absolute; left:148px; top:19967px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">to use an assertion to block the illegal cases.</span></div>
<div class="txt" style="position:absolute; left:938px; top:19824px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">switch (vowel) {</span></div>
<div class="txt" style="position:absolute; left:1023px; top:19863px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">case 'a':</span></div>
<div class="txt" style="position:absolute; left:1023px; top:19901px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">case 'e':</span></div>
<div class="txt" style="position:absolute; left:1023px; top:19940px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">case 'i':</span></div>
<div class="txt" style="position:absolute; left:1023px; top:19978px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">case 'o':</span></div>
<div class="txt" style="position:absolute; left:1023px; top:20016px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">case 'u': return "A";</span></div>
<div class="txt" style="position:absolute; left:1023px; top:20055px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">default: </span><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">assert false;</span></div>
<div class="txt" style="position:absolute; left:938px; top:20093px;"><span id="f31" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<img id="background" style="position:absolute; left:0px; top:20263px;" width="1440" height="1080" src="page18.png"> <img id="background" style="position:absolute; left:1440px; top:20263px;" width="1440" height="1080" src="page-000018.png">
<div class="txt" style="position:absolute; left:804px; top:20281px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:20370px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What to Assert: more scenarios</span></div>
<div class="txt" style="position:absolute; left:76px; top:20510px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">An input parameter’s value falls within its expected range (or an</span></div>
<div class="txt" style="position:absolute; left:112px; top:20558px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">output parameter’s value does) </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">判断输入值是否在指定范围</span></div>
<div class="txt" style="position:absolute; left:76px; top:20630px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A file or stream is open (or closed) when a method begins</span></div>
<div class="txt" style="position:absolute; left:112px; top:20678px;"><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">executing (or when it ends executing) </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">文件或流是否打开</span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">/</span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">关闭</span></div>
<div class="txt" style="position:absolute; left:76px; top:20750px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A file or stream is at the beginning (or end) when a method begins</span></div>
<div class="txt" style="position:absolute; left:112px; top:20798px;"><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">executing (or when it ends executing) </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">文件或流的当前指针是否在最开</span></div>
<div class="txt" style="position:absolute; left:112px; top:20843px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">始或者最后</span></div>
<div class="txt" style="position:absolute; left:76px; top:20912px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A file or stream is open for read-only, write-only, or both read and</span></div>
<div class="txt" style="position:absolute; left:112px; top:20960px;"><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">write </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">文件或流的读写性控制</span></div>
<div class="txt" style="position:absolute; left:76px; top:21032px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The value of an input-only variable is not changed by a method </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">只</span></div>
<div class="txt" style="position:absolute; left:112px; top:21077px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">读输入参数是否被修改</span></div>
<img id="background" style="position:absolute; left:0px; top:21452px;" width="1440" height="1080" src="page19.png"> <img id="background" style="position:absolute; left:1440px; top:21452px;" width="1440" height="1080" src="page-000019.png">
<div class="txt" style="position:absolute; left:804px; top:21470px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:21559px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What to Assert: more scenarios</span></div>
<div class="txt" style="position:absolute; left:76px; top:21699px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A pointer is non-NULL</span></div>
<div class="txt" style="position:absolute; left:76px; top:21771px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">An array or other container passed into a method can contain at least</span></div>
<div class="txt" style="position:absolute; left:112px; top:21821px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">X number of data elements</span></div>
<div class="txt" style="position:absolute; left:76px; top:21891px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A table has been initialized to contain real values</span></div>
<div class="txt" style="position:absolute; left:76px; top:21963px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A container is empty (or full) when a method begins executing (or</span></div>
<div class="txt" style="position:absolute; left:112px; top:22013px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">when it finishes)</span></div>
<div class="txt" style="position:absolute; left:76px; top:22083px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The results from a highly optimized, complicated method match the</span></div>
<div class="txt" style="position:absolute; left:112px; top:22131px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">results from a slower but clearly written routine </span><span id="f29" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">两个结果是否匹配</span></div>
<img id="background" style="position:absolute; left:0px; top:22641px;" width="1440" height="1080" src="page20.png"> <img id="background" style="position:absolute; left:1440px; top:22641px;" width="1440" height="1080" src="page-000020.png">
<div class="txt" style="position:absolute; left:33px; top:22748px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">When to use assertions?</span></div>
<div class="txt" style="position:absolute; left:804px; top:22659px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:22888px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Normally, you don’t want users to see assertion messages in</span></div>
<div class="txt" style="position:absolute; left:112px; top:22938px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">production code; assertions are primarily for use during</span></div>
<div class="txt" style="position:absolute; left:112px; top:22986px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">development and maintenance.</span></div>
<div class="txt" style="position:absolute; left:76px; top:23056px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions are normally compiled into the code at development</span></div>
<div class="txt" style="position:absolute; left:112px; top:23106px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">time and compiled out of the code for production. During</span></div>
<div class="txt" style="position:absolute; left:112px; top:23154px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">development, assertions flush out contradictory assumptions,</span></div>
<div class="txt" style="position:absolute; left:112px; top:23197px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">unexpected conditions, bad values passed to routines, and so on. </span><span id="f24" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">在</span></div>
<div class="txt" style="position:absolute; left:112px; top:23245px;"><span id="f24" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">开发和调试阶段使用断言，帮助发现错误和异常。</span></div>
<div class="txt" style="position:absolute; left:76px; top:23320px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">During production, they are compiled out of the code so that the</span></div>
<div class="txt" style="position:absolute; left:112px; top:23365px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">assertions don’t degrade system performance. </span><span id="f24" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">在发布时禁用断言，</span></div>
<div class="txt" style="position:absolute; left:112px; top:23413px;"><span id="f24" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">避免影响性能。</span></div>
<div class="txt" style="position:absolute; left:76px; top:23488px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">When should you write runtime assertions? As you write the code,</span></div>
<div class="txt" style="position:absolute; left:112px; top:23538px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">not after the fact. When you’re writing the code, you have the</span></div>
<div class="txt" style="position:absolute; left:112px; top:23586px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">invariants in mind. If you postpone writing assertions, you’re less</span></div>
<div class="txt" style="position:absolute; left:112px; top:23634px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">likely to do it, and you’re liable to omit some important invariants.</span></div>
<img id="background" style="position:absolute; left:0px; top:23830px;" width="1440" height="1080" src="page21.png"> <img id="background" style="position:absolute; left:1440px; top:23830px;" width="1440" height="1080" src="page-000021.png">
<div class="txt" style="position:absolute; left:33px; top:23937px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What Not to Assert?</span></div>
<div class="txt" style="position:absolute; left:804px; top:23848px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:24077px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Runtime assertions are not free. They can clutter the code, so they</span></div>
<div class="txt" style="position:absolute; left:112px; top:24122px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">must be used judiciously. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">断言不是免费的，需要慎用</span></div>
<div class="txt" style="position:absolute; left:112px; top:24192px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Avoid trivial assertions, just as you would avoid uninformative</span></div>
<div class="txt" style="position:absolute; left:148px; top:24235px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">comments.</span></div>
<div class="txt" style="position:absolute; left:156px; top:24304px;"><span id="f36" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">// don't do this:</span></div>
<div class="txt" style="position:absolute; left:156px; top:24354px;"><span id="f36" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">x = y + 1;</span></div>
<div class="txt" style="position:absolute; left:156px; top:24404px;"><span id="f36" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">assert x == y+1;</span></div>
<div class="txt" style="position:absolute; left:112px; top:24477px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f24" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">This assertion doesn’t find bugs in your code.</span></div>
<div class="txt" style="position:absolute; left:112px; top:24537px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">It finds bugs in the compiler or Java virtual machine, which are</span></div>
<div class="txt" style="position:absolute; left:148px; top:24581px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">components that you should trust until you have good reason to doubt</span></div>
<div class="txt" style="position:absolute; left:148px; top:24620px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">them. </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">对于可以信任的内容不要使用断言进行检测，如：编译器不会算错</span></div>
<div class="txt" style="position:absolute; left:148px; top:24667px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">y+1</span></div>
<div class="txt" style="position:absolute; left:112px; top:24727px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If an assertion is obvious from its local context, leave it out.</span></div>
<img id="background" style="position:absolute; left:0px; top:25019px;" width="1440" height="1080" src="page22.png"> <img id="background" style="position:absolute; left:1440px; top:25019px;" width="1440" height="1080" src="page-000022.png">
<div class="txt" style="position:absolute; left:804px; top:25037px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:25126px;"><span id="f10" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Don’t Assert External Conditions</span></div>
<div class="txt" style="position:absolute; left:76px; top:25266px;"><span id="f12" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Never use assertions to test conditions that are external to your</span></div>
<div class="txt" style="position:absolute; left:112px; top:25311px;"><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">program. </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不要用断言来测试外部的条件</span></div>
<div class="txt" style="position:absolute; left:112px; top:25381px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Such as the existence of files, the availability of the network, or the</span></div>
<div class="txt" style="position:absolute; left:148px; top:25424px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">correctness of input typed by a human user.</span></div>
<div class="txt" style="position:absolute; left:112px; top:25484px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions test the internal state of your program to ensure that it is within</span></div>
<div class="txt" style="position:absolute; left:148px; top:25524px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the bounds of its specification. </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">断言用于检测程序内部的内容</span></div>
<div class="txt" style="position:absolute; left:112px; top:25588px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">When an assertion fails, it indicates that the program has run off the rails</span></div>
<div class="txt" style="position:absolute; left:148px; top:25631px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">in some sense, into a state in which it was not designed to function</span></div>
<div class="txt" style="position:absolute; left:148px; top:25671px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">properly. Assertion failures therefore indicate bugs. </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">当断言失败时，说明</span></div>
<div class="txt" style="position:absolute; left:148px; top:25714px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">程序的实现有问题，存在</span><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">bugs</span></div>
<div class="txt" style="position:absolute; left:112px; top:25778px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">External failures are not bugs, and there is no change you can make to</span></div>
<div class="txt" style="position:absolute; left:148px; top:25818px;"><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">your program in advance that will prevent them from happening. </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">外部因</span></div>
<div class="txt" style="position:absolute; left:148px; top:25861px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">素导致的失败不是</span><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">bugs</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">，是程序无法预测和控制的</span></div>
<div class="txt" style="position:absolute; left:112px; top:25925px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">External failures should be handled using exceptions instead</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">. Avoid</span></div>
<div class="txt" style="position:absolute; left:148px; top:25964px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">trivial assertions, just as you would avoid uninformative comments. </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">外部</span></div>
<div class="txt" style="position:absolute; left:148px; top:26008px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">因素导致的失败应该采用</span><span id="f14" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">exception</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">机制处理</span></div>
<img id="background" style="position:absolute; left:0px; top:26208px;" width="1440" height="1080" src="page23.png"> <img id="background" style="position:absolute; left:1440px; top:26208px;" width="1440" height="1080" src="page-000023.png">
<div class="txt" style="position:absolute; left:804px; top:26226px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:26315px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Turn on/off Assert in different phases</span></div>
<div class="txt" style="position:absolute; left:67px; top:26444px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Many assertion mechanisms are designed so that assertions are</span></div>
<div class="txt" style="position:absolute; left:103px; top:26493px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">executed only during testing and debugging, and turned off when</span></div>
<div class="txt" style="position:absolute; left:103px; top:26540px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">the program is released to users. </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">在测试和调试阶段打开断言</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">快速发现和</span></div>
<div class="txt" style="position:absolute; left:103px; top:26585px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">定位</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">bugs)</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">，在程序发布后关闭断言</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">提升性能</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">)</span></div>
<div class="txt" style="position:absolute; left:67px; top:26654px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f41" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Java’s assert statement behaves this way. </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">(however, assertions are</span></div>
<div class="txt" style="position:absolute; left:103px; top:26702px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">off by default) </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">Java</span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">默认关闭断言</span></div>
<div class="txt" style="position:absolute; left:67px; top:26774px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The advantage of this approach is that you can write very</span></div>
<div class="txt" style="position:absolute; left:103px; top:26824px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">expensive assertions that would otherwise seriously degrade the</span></div>
<div class="txt" style="position:absolute; left:103px; top:26872px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">performance of your program. </span><span id="f18" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,255,1);">这样可以在测试阶段使用一些时空开销大的断</span></div>
<div class="txt" style="position:absolute; left:103px; top:26915px;"><span id="f18" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,255,1);">言技术快速发现错误。</span></div>
<div class="txt" style="position:absolute; left:104px; top:26974px;"><span id="f59" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">For example, a procedure that searches an array using binary search has a</span></div>
<div class="txt" style="position:absolute; left:139px; top:27013px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">requirement that the array be sorted</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">. E.g., </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">二分搜索中检测数组是否排好序</span></div>
<div class="txt" style="position:absolute; left:104px; top:27078px;"><span id="f59" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Asserting this requirement requires scanning through the entire array,</span></div>
<div class="txt" style="position:absolute; left:139px; top:27121px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">however, turning an operation that should run in logarithmic time into</span></div>
<div class="txt" style="position:absolute; left:139px; top:27164px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">one that takes linear time. You should be willing to pay this cost during</span></div>
<div class="txt" style="position:absolute; left:139px; top:27207px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">testing, since it makes debugging much easier, but not after the program is</span></div>
<div class="txt" style="position:absolute; left:139px; top:27250px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">released to users.</span></div>
<img id="background" style="position:absolute; left:0px; top:27397px;" width="1440" height="1080" src="page24.png"> <img id="background" style="position:absolute; left:1440px; top:27397px;" width="1440" height="1080" src="page-000024.png">
<div class="txt" style="position:absolute; left:804px; top:27415px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:27504px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Suggestion: always enable assertions</span></div>
<div class="txt" style="position:absolute; left:76px; top:27644px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">However, disabling assertions in release has a serious</span></div>
<div class="txt" style="position:absolute; left:112px; top:27694px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">disadvantage.</span></div>
<div class="txt" style="position:absolute; left:76px; top:27764px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">With assertions disabled, a program has far less error checking</span></div>
<div class="txt" style="position:absolute; left:112px; top:27814px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">when it needs it most.</span></div>
<div class="txt" style="position:absolute; left:76px; top:27884px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Novice programmers are usually much more concerned about the</span></div>
<div class="txt" style="position:absolute; left:112px; top:27934px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">performance impact of assertions than they should be.</span></div>
<div class="txt" style="position:absolute; left:76px; top:28004px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Most assertions are cheap, so they should not be disabled in the</span></div>
<div class="txt" style="position:absolute; left:112px; top:28049px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">official release. </span><span id="f26" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">如果断言对性能影响并不大，在发布版本中可以保留</span></div>
<img id="background" style="position:absolute; left:0px; top:28586px;" width="1440" height="1080" src="page25.png"> <img id="background" style="position:absolute; left:1440px; top:28586px;" width="1440" height="1080" src="page-000025.png">
<div class="txt" style="position:absolute; left:804px; top:28604px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:28693px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Enable &amp; Disable assertions in Java</span></div>
<div class="txt" style="position:absolute; left:76px; top:28833px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Enable assertions</span></div>
<div class="txt" style="position:absolute; left:112px; top:28899px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Running the program with the </span><span id="f18" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,255,1);">-enableassertions </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">or </span><span id="f18" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,255,1);">-ea </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">option:</span></div>
<div class="txt" style="position:absolute; left:148px; top:28956px;"><span id="f25" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f18" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">java -enableassertions MyApp</span></div>
<div class="txt" style="position:absolute; left:112px; top:29006px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">The option -ea... turns on assertions in all classes of the default package.</span></div>
<div class="txt" style="position:absolute; left:148px; top:29063px;"><span id="f25" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f18" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">java -ea:MyClass -ea:com.mycompany.mylib... MyApp</span></div>
<div class="txt" style="position:absolute; left:76px; top:29118px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Disable assertions</span></div>
<div class="txt" style="position:absolute; left:112px; top:29184px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Running the program with the </span><span id="f18" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,255,1);">-disableassertions </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">or </span><span id="f18" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,255,1);">-da </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">option:</span></div>
<div class="txt" style="position:absolute; left:148px; top:29242px;"><span id="f25" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f18" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">java -ea:... -da:MyClass MyApp</span></div>
<div class="txt" style="position:absolute; left:76px; top:29297px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">By default, assertions are disabled.</span></div>
<div class="txt" style="position:absolute; left:76px; top:29369px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Enable assertions in Eclipse:</span></div>
<div class="txt" style="position:absolute; left:112px; top:29435px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">In preferences, go to </span><span id="f67" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Java → Installed JREs . Click “Java SE 8”, click</span></div>
<div class="txt" style="position:absolute; left:148px; top:29478px;"><span id="f67" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">“Edit…”, and in the “Default VM arguments” box enter: </span><span id="f18" style="font-size:15px;vertical-align:baseline;color:rgba(0,0,255,1);">-ea</span></div>
<img id="background" style="position:absolute; left:0px; top:29775px;" width="1440" height="1080" src="page26.png"> <img id="background" style="position:absolute; left:1440px; top:29775px;" width="1440" height="1080" src="page-000026.png">
<div class="txt" style="position:absolute; left:804px; top:29793px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:29881px;"><span id="f10" style="font-size:39px;vertical-align:baseline;color:rgba(0,0,0,1);">assert </span><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">vs. </span><span id="f13" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">assertXXX()… </span><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">in JUnit</span></div>
<div class="txt" style="position:absolute; left:76px; top:30022px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The Java assert statement is a different mechanism from the JUnit</span></div>
<div class="txt" style="position:absolute; left:112px; top:30071px;"><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">methods </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assertTrue()</span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">, </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assertEquals(), </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">etc.</span></div>
<div class="txt" style="position:absolute; left:76px; top:30142px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">They all assert a predicate about your code, but are designed for</span></div>
<div class="txt" style="position:absolute; left:112px; top:30192px;"><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">use in different contexts.</span></div>
<div class="txt" style="position:absolute; left:76px; top:30262px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assert </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">statement should be used in implementation code, for</span></div>
<div class="txt" style="position:absolute; left:112px; top:30312px;"><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">defensive checks inside the implementation.</span></div>
<div class="txt" style="position:absolute; left:76px; top:30382px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">JUnit </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assertXXX() </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">methods should be used in JUnit tests, to check</span></div>
<div class="txt" style="position:absolute; left:112px; top:30432px;"><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">the result of a test.</span></div>
<div class="txt" style="position:absolute; left:76px; top:30502px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assert </span><span id="f44" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">statements don’t run without </span><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">-ea</span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">, but the JUnit</span></div>
<div class="txt" style="position:absolute; left:112px; top:30551px;"><span id="f10" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">assertXXX() </span><span id="f18" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">methods always run.</span></div>
<img id="background" style="position:absolute; left:0px; top:30964px;" width="1440" height="1080" src="page27.png"> <img id="background" style="position:absolute; left:1440px; top:30964px;" width="1440" height="1080" src="page-000027.png">
<div class="txt" style="position:absolute; left:1105px; top:30982px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:159px; top:31379px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">(3) Guidelines for Using Assertions</span></div>
<img id="background" style="position:absolute; left:0px; top:32153px;" width="1440" height="1080" src="page28.png"> <img id="background" style="position:absolute; left:1440px; top:32153px;" width="1440" height="1080" src="page-000028.png">
<div class="txt" style="position:absolute; left:33px; top:32260px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertion vs. Exception?</span></div>
<div class="txt" style="position:absolute; left:804px; top:32171px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:32400px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Assertions </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">generally cover correctness issues of program.</span></div>
<div class="txt" style="position:absolute; left:76px; top:32472px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Exceptions </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">generally cover robustness issues of program.</span></div>
<div class="txt" style="position:absolute; left:76px; top:32544px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions are especially useful in large, complicated programs</span></div>
<div class="txt" style="position:absolute; left:112px; top:32589px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">and in high reliability programs.</span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">断言在大型复杂程序和高可靠性程</span></div>
<div class="txt" style="position:absolute; left:112px; top:32637px;"><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">序中特别有用。</span></div>
<div class="txt" style="position:absolute; left:112px; top:32707px;"><span id="f27" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">They enable programmers to more quickly flush out mismatched interface</span></div>
<div class="txt" style="position:absolute; left:148px; top:32750px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">assumptions, errors that creep in when code is modified, and so on.</span></div>
<div class="txt" style="position:absolute; left:76px; top:32937px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Recall: </span><span id="f33" style="font-size:26px;vertical-align:baseline;color:rgba(0,0,0,1);">checkRep() </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">in Chapter 2 ADT for </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Rep Invariants.</span></div>
<img id="background" style="position:absolute; left:0px; top:33342px;" width="1440" height="1080" src="page29.png"> <img id="background" style="position:absolute; left:1440px; top:33342px;" width="1440" height="1080" src="page-000029.png">
<div class="txt" style="position:absolute; left:33px; top:33449px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions vs. exceptions</span></div>
<div class="txt" style="position:absolute; left:804px; top:33360px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:33589px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Use error handling code (exception) for conditions you expect to</span></div>
<div class="txt" style="position:absolute; left:112px; top:33637px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">occur; </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">用</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">exception</span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">来处理期望发生的情况</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">知道会发生，但是不知何时</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">)</span></div>
<div class="txt" style="position:absolute; left:76px; top:33709px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Use assertions for conditions that should never occur </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">用断言来处理</span></div>
<div class="txt" style="position:absolute; left:112px; top:33754px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">绝对不该发生的情况</span></div>
<div class="txt" style="position:absolute; left:112px; top:33818px;"><span id="f35" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Assertions check for conditions that should never occur</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">. </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Error handling</span></div>
<div class="txt" style="position:absolute; left:148px; top:33862px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">code checks for off-nominal circumstances that might not occur very</span></div>
<div class="txt" style="position:absolute; left:148px; top:33905px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">often</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">, but that have been anticipated by the programmer who wrote the</span></div>
<div class="txt" style="position:absolute; left:148px; top:33948px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">code and that need to be handled by the production code. </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">Error-handling</span></div>
<div class="txt" style="position:absolute; left:148px; top:33991px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">typically checks for bad input data; assertions check for bugs in the</span></div>
<div class="txt" style="position:absolute; left:148px; top:34030px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">code. Exception</span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">处理错误的输入 数据，断言检查</span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">bugs</span></div>
<div class="txt" style="position:absolute; left:112px; top:34095px;"><span id="f35" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If error handling code is used to address an anomalous condition, the</span></div>
<div class="txt" style="position:absolute; left:148px; top:34138px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">error handling will enable the program to respond to the error gracefully.</span></div>
<div class="txt" style="position:absolute; left:112px; top:34198px;"><span id="f35" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If an assertion is fired for an anomalous condition, the corrective action is</span></div>
<div class="txt" style="position:absolute; left:148px; top:34242px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">not merely to handle an error gracefully</span><span id="f65" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">—</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the corrective action is to</span></div>
<div class="txt" style="position:absolute; left:148px; top:34285px;"><span id="f65" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">change the program’s source code, recompile, and release a new version of</span></div>
<div class="txt" style="position:absolute; left:148px; top:34328px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the software.</span></div>
<img id="background" style="position:absolute; left:0px; top:34531px;" width="1440" height="1080" src="page30.png"> <img id="background" style="position:absolute; left:1440px; top:34531px;" width="1440" height="1080" src="page-000030.png">
<div class="txt" style="position:absolute; left:804px; top:34549px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:34638px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Avoid putting executable code in assertions</span></div>
<div class="txt" style="position:absolute; left:76px; top:34778px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Since assertions may be disabled, the correctness of your program</span></div>
<div class="txt" style="position:absolute; left:112px; top:34828px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">should never depend on whether or not the assertion expressions</span></div>
<div class="txt" style="position:absolute; left:112px; top:34876px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">are executed. </span><span id="f18" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,255,1);">断言在程序发布后，有可能被关闭，所以不要在其中写业务代码</span></div>
<div class="txt" style="position:absolute; left:76px; top:34946px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">In particular, asserted expressions should not have </span><span id="f22" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">side-effects .</span></div>
<div class="txt" style="position:absolute; left:112px; top:35013px;"><span id="f27" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">For example, if you want to assert that an element removed from a list was</span></div>
<div class="txt" style="position:absolute; left:148px; top:35056px;"><span id="f30" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">actually found in the list, don’t write it like this:</span></div>
<div class="txt" style="position:absolute; left:76px; top:35122px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If assertions are disabled, the entire expression is skipped, and x is</span></div>
<div class="txt" style="position:absolute; left:112px; top:35171px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">never removed from the list. Write it like this instead:</span></div>
<div class="txt" style="position:absolute; left:156px; top:35277px;"><span id="f37" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">// don't do this:</span></div>
<div class="txt" style="position:absolute; left:156px; top:35327px;"><span id="f37" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">assert list.remove(x);</span></div>
<div class="txt" style="position:absolute; left:792px; top:35278px;"><span id="f37" style="font-size:14px;vertical-align:baseline;color:rgba(255,0,0,1);">// do this:</span></div>
<div class="txt" style="position:absolute; left:792px; top:35328px;"><span id="f37" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">boolean found = list.remove(x);</span></div>
<div class="txt" style="position:absolute; left:792px; top:35378px;"><span id="f37" style="font-size:14px;vertical-align:baseline;color:rgba(0,0,0,1);">assert found;</span></div>
<img id="background" style="position:absolute; left:0px; top:35720px;" width="1440" height="1080" src="page31.png"> <img id="background" style="position:absolute; left:1440px; top:35720px;" width="1440" height="1080" src="page-000031.png">
<div class="txt" style="position:absolute; left:804px; top:35738px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:35827px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Use Assertions for pre-/post- conditions</span></div>
<div class="txt" style="position:absolute; left:76px; top:35967px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Preconditions and postconditions are part of an approach to</span></div>
<div class="txt" style="position:absolute; left:112px; top:36017px;"><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">program design and development known as “design by contract”.</span></div>
<div class="txt" style="position:absolute; left:112px; top:36082px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">When preconditions and postconditions are used, each routine or class</span></div>
<div class="txt" style="position:absolute; left:148px; top:36125px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">forms a contract with the rest of the program.</span></div>
<div class="txt" style="position:absolute; left:112px; top:36186px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Preconditions are the properties that the client code of a routine or class</span></div>
<div class="txt" style="position:absolute; left:148px; top:36229px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">promises will be true before it calls the routine or instantiates the object.</span></div>
<div class="txt" style="position:absolute; left:148px; top:36272px;"><span id="f32" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Preconditions are the client code’s obligations to the code it calls.</span></div>
<div class="txt" style="position:absolute; left:112px; top:36332px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Postconditions are the properties that the routine or class promises will</span></div>
<div class="txt" style="position:absolute; left:148px; top:36376px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">be true when it concludes executing. </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Postconditions are the routine or</span></div>
<div class="txt" style="position:absolute; left:148px; top:36419px;"><span id="f32" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">class’s obligations to the code that uses it.</span></div>
<div class="txt" style="position:absolute; left:76px; top:36484px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Assertions are a useful tool for documenting preconditions and</span></div>
<div class="txt" style="position:absolute; left:112px; top:36534px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">postconditions.</span></div>
<div class="txt" style="position:absolute; left:112px; top:36599px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">Comments </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">could be used to document preconditions and postconditions,</span></div>
<div class="txt" style="position:absolute; left:148px; top:36642px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">but </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">assertions </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">can check dynamically whether the preconditions and</span></div>
<div class="txt" style="position:absolute; left:148px; top:36686px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">postconditions are true.</span></div>
<img id="background" style="position:absolute; left:0px; top:36909px;" width="1440" height="1080" src="page32.png"> <img id="background" style="position:absolute; left:1440px; top:36909px;" width="1440" height="1080" src="page-000032.png">
<div class="txt" style="position:absolute; left:804px; top:36927px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:37016px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Use Assertions for pre-/post- conditions</span></div>
<div class="txt" style="position:absolute; left:76px; top:37156px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If the variables latitude, longitude, and elevation were coming</span></div>
<div class="txt" style="position:absolute; left:112px; top:37206px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">from an external source, invalid values should be checked and</span></div>
<div class="txt" style="position:absolute; left:112px; top:37254px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">handled by error handling code rather than assertions.</span></div>
<div class="txt" style="position:absolute; left:76px; top:37324px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If the variables are coming from a</span></div>
<div class="txt" style="position:absolute; left:112px; top:37361px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">trusted, internal source, however, </span><span id="f30" style="font-size:12px;vertical-align:super;color:rgba(0,0,0,1);">float latitude;</span></div>
<div class="txt" style="position:absolute; left:112px; top:37422px;"><span id="f24" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">and the routine’s design is based</span></div>
<div class="txt" style="position:absolute; left:745px; top:37405px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">float longitude;</span></div>
<div class="txt" style="position:absolute; left:745px; top:37448px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">float elevation;</span></div>
<div class="txt" style="position:absolute; left:112px; top:37470px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">on the assumption that these</span></div>
<div class="txt" style="position:absolute; left:112px; top:37518px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">values will be within their valid</span></div>
<div class="txt" style="position:absolute; left:112px; top:37566px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">ranges, then assertions are</span></div>
<div class="txt" style="position:absolute; left:112px; top:37614px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">appropriate.</span></div>
<div class="txt" style="position:absolute; left:745px; top:37536px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">//Preconditions</span></div>
<div class="txt" style="position:absolute; left:745px; top:37580px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">assert latitude&gt;=-90 &amp;&amp; latitude&lt;=90;</span></div>
<div class="txt" style="position:absolute; left:745px; top:37623px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">assert longitude&gt;=0 &amp;&amp; longitude&lt;360;</span></div>
<div class="txt" style="position:absolute; left:745px; top:37667px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">assert elevation&gt;=-500 &amp;&amp; elevation&lt;=75000;</span></div>
<div class="txt" style="position:absolute; left:745px; top:37711px;"><span id="f42" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,0,1);">……</span></div>
<div class="txt" style="position:absolute; left:745px; top:37754px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">//Postconditions</span></div>
<div class="txt" style="position:absolute; left:745px; top:37798px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">assert Velocity&gt;=0 &amp;&amp; Velocity &lt;= 600</span></div>
<div class="txt" style="position:absolute; left:745px; top:37885px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">//return value</span></div>
<div class="txt" style="position:absolute; left:745px; top:37929px;"><span id="f30" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">return Velocity;</span></div>
<img id="background" style="position:absolute; left:0px; top:38098px;" width="1440" height="1080" src="page33.png"> <img id="background" style="position:absolute; left:1440px; top:38098px;" width="1440" height="1080" src="page-000033.png">
<div class="txt" style="position:absolute; left:804px; top:38116px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:38205px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Combine assert and error handling for robustness</span></div>
<div class="txt" style="position:absolute; left:76px; top:38345px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">For highly robust code, assert, and then handle the error anyway</span></div>
<div class="txt" style="position:absolute; left:112px; top:38412px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">For any given error condition a routine will generally use either an</span></div>
<div class="txt" style="position:absolute; left:148px; top:38455px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">assertion or error-handling code, but not both. Some experts argue that</span></div>
<div class="txt" style="position:absolute; left:148px; top:38498px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">only one kind is needed (Meyer 1997).</span></div>
<div class="txt" style="position:absolute; left:76px; top:38564px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">But real-world programs and projects tend to be too messy to rely</span></div>
<div class="txt" style="position:absolute; left:112px; top:38609px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">solely on assertions. </span><span id="f28" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">真实世界的程序和项目往往太杂乱，不能完全依</span></div>
<div class="txt" style="position:absolute; left:112px; top:38657px;"><span id="f28" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">靠断言。</span></div>
<div class="txt" style="position:absolute; left:112px; top:38727px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">On a large, long-lasting system, different parts might be designed by</span></div>
<div class="txt" style="position:absolute; left:148px; top:38770px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">different designers over a period of 5-10 years or more. The designers will</span></div>
<div class="txt" style="position:absolute; left:148px; top:38813px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">be separated in time, across numerous versions, and separated</span></div>
<div class="txt" style="position:absolute; left:148px; top:38856px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">geographically. Their designs will focus on different technologies at</span></div>
<div class="txt" style="position:absolute; left:148px; top:38899px;"><span id="f41" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">different points in the system’s development.</span></div>
<div class="txt" style="position:absolute; left:112px; top:38960px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Programmers will have worked to different coding standards at different</span></div>
<div class="txt" style="position:absolute; left:148px; top:39003px;"><span id="f41" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">points in the system’s lifetime. On a large development team, </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">some</span></div>
<div class="txt" style="position:absolute; left:148px; top:39046px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">programmers will inevitably be more conscientious than others and some</span></div>
<div class="txt" style="position:absolute; left:148px; top:39090px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">parts of the code will be reviewed more rigorously than other parts of the</span></div>
<div class="txt" style="position:absolute; left:148px; top:39133px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">code.</span></div>
<img id="background" style="position:absolute; left:0px; top:39287px;" width="1440" height="1080" src="page34.png"> <img id="background" style="position:absolute; left:1440px; top:39287px;" width="1440" height="1080" src="page-000034.png">
<div class="txt" style="position:absolute; left:804px; top:39305px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:39394px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Combine assert and error handling for robustness</span></div>
<div class="txt" style="position:absolute; left:76px; top:39534px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">Both assertions and error handling code might be used to address</span></div>
<div class="txt" style="position:absolute; left:112px; top:39579px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">the same error. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">有些情况下断言和错误处理代码都可以用来解决相同</span></div>
<div class="txt" style="position:absolute; left:112px; top:39627px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">的错误。</span></div>
<div class="txt" style="position:absolute; left:76px; top:39702px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">E.g., in the source code for Microsoft Word, for example, conditions</span></div>
<div class="txt" style="position:absolute; left:112px; top:39752px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">that should always be true are asserted, but such errors are also</span></div>
<div class="txt" style="position:absolute; left:112px; top:39800px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">handled by error-handling code in case the assertion fails.</span></div>
<div class="txt" style="position:absolute; left:76px; top:39870px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">For extremely large, complex, long-lived applications like Word,</span></div>
<div class="txt" style="position:absolute; left:112px; top:39920px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">assertions are valuable because they help to flush out as many</span></div>
<div class="txt" style="position:absolute; left:112px; top:39968px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">development-time errors as possible.</span></div>
<div class="txt" style="position:absolute; left:76px; top:40038px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">But the application is so complex (million of lines of code) and has</span></div>
<div class="txt" style="position:absolute; left:112px; top:40088px;"><span id="f37" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">gone through so many generations of modification that it isn’t</span></div>
<div class="txt" style="position:absolute; left:112px; top:40136px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">realistic to assume that every conceivable error will be detected</span></div>
<div class="txt" style="position:absolute; left:112px; top:40184px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">and corrected before the software ships, and so errors must be</span></div>
<div class="txt" style="position:absolute; left:112px; top:40232px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">handled in the production version of the system as well.</span></div>
<img id="background" style="position:absolute; left:0px; top:40476px;" width="1440" height="1080" src="page35.png"> <img id="background" style="position:absolute; left:1440px; top:40476px;" width="1440" height="1080" src="page-000035.png">
<div class="txt" style="position:absolute; left:1105px; top:40494px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:305px; top:40887px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">3 Defensive Programming</span></div>
<img id="background" style="position:absolute; left:0px; top:41665px;" width="1440" height="1080" src="page36.png"> <img id="background" style="position:absolute; left:1440px; top:41665px;" width="1440" height="1080" src="page-000036.png">
<div class="txt" style="position:absolute; left:804px; top:41683px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:41772px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What is defensive programming?</span></div>
<div class="txt" style="position:absolute; left:66px; top:41912px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Defensive programming </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">is a form of defensive design intended to</span></div>
<div class="txt" style="position:absolute; left:102px; top:41962px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">ensure the continuing function of a piece of software under</span></div>
<div class="txt" style="position:absolute; left:102px; top:42005px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">unforeseen circumstances. </span><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">防御性编程是防御性设计的一种形式，旨</span></div>
<div class="txt" style="position:absolute; left:102px; top:42053px;"><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">在确保在不可预见情况下软件持续提供功能的能力。</span></div>
<div class="txt" style="position:absolute; left:102px; top:42123px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Defensive programming practices are often used where high availability,</span></div>
<div class="txt" style="position:absolute; left:138px; top:42166px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">safety or security is needed.</span></div>
<div class="txt" style="position:absolute; left:66px; top:42232px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">In defensive programming, </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">the main idea is that if a method is</span></div>
<div class="txt" style="position:absolute; left:102px; top:42281px;"><span id="f30" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">passed bad data, it won’t be hurt, even if the bad data is another</span></div>
<div class="txt" style="position:absolute; left:102px; top:42325px;"><span id="f30" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">routine’s fault</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">. </span><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">主要思想：如果某个方法被传入了不良数据，即使这</span></div>
<div class="txt" style="position:absolute; left:102px; top:42373px;"><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">是另一个子程序的错误，方法本身也不会受到破坏。</span></div>
<div class="txt" style="position:absolute; left:102px; top:42442px;"><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f40" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">More generally, it’s the recognition that programs will have problems and</span></div>
<div class="txt" style="position:absolute; left:138px; top:42486px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">modifications, and that a smart programmer will develop code</span></div>
<div class="txt" style="position:absolute; left:138px; top:42529px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">accordingly.</span></div>
<img id="background" style="position:absolute; left:0px; top:42854px;" width="1440" height="1080" src="page37.png"> <img id="background" style="position:absolute; left:1440px; top:42854px;" width="1440" height="1080" src="page-000037.png">
<div class="txt" style="position:absolute; left:804px; top:42872px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:42961px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">What is defensive programming?</span></div>
<div class="txt" style="position:absolute; left:76px; top:43101px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Defensive programming </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">DOESN’T MEAN being defensive about</span></div>
<div class="txt" style="position:absolute; left:112px; top:43151px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">your programming</span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">—”It does so work!”</span></div>
<div class="txt" style="position:absolute; left:76px; top:43221px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The idea is based on defensive driving.</span></div>
<div class="txt" style="position:absolute; left:112px; top:43288px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">In defensive driving, you adopt the mind-</span><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">set that you’re never sure what</span></div>
<div class="txt" style="position:absolute; left:148px; top:43331px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the other drivers are going to do.</span></div>
<div class="txt" style="position:absolute; left:112px; top:43391px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">That way, you make sure</span></div>
<div class="txt" style="position:absolute; left:148px; top:43435px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">that if they do something</span></div>
<div class="txt" style="position:absolute; left:148px; top:43478px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">dangerous you won’t be</span></div>
<div class="txt" style="position:absolute; left:148px; top:43521px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">hurt.</span></div>
<div class="txt" style="position:absolute; left:112px; top:43582px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">You take responsibility for</span></div>
<div class="txt" style="position:absolute; left:148px; top:43625px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">protecting yourself even</span></div>
<div class="txt" style="position:absolute; left:148px; top:43668px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">when it might be the other</span></div>
<div class="txt" style="position:absolute; left:148px; top:43711px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">driver’s fault.</span></div>
<img id="background" style="position:absolute; left:0px; top:44043px;" width="1440" height="1080" src="page38.png"> <img id="background" style="position:absolute; left:1440px; top:44043px;" width="1440" height="1080" src="page-000038.png">
<div class="txt" style="position:absolute; left:804px; top:44061px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:44150px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Benefits of defensive programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:44290px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Defensive programming is an approach to improve software and</span></div>
<div class="txt" style="position:absolute; left:112px; top:44340px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">source code, in terms of:</span></div>
<div class="txt" style="position:absolute; left:112px; top:44405px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">General quality </span><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">reducing the number of software bugs and problems.</span></div>
<div class="txt" style="position:absolute; left:112px; top:44465px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Making the source code comprehensible </span><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the source code should be</span></div>
<div class="txt" style="position:absolute; left:148px; top:44508px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">readable and understandable so it is approved in a code audit.</span></div>
<div class="txt" style="position:absolute; left:112px; top:44569px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Making the software behave in a predictable manner </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">despite unexpected</span></div>
<div class="txt" style="position:absolute; left:148px; top:44612px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">inputs or user actions.</span></div>
<img id="background" style="position:absolute; left:0px; top:45232px;" width="1440" height="1080" src="page39.png"> <img id="background" style="position:absolute; left:1440px; top:45232px;" width="1440" height="1080" src="page-000039.png">
<div class="txt" style="position:absolute; left:1105px; top:45250px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:321px; top:45561px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">Techniques for defensive</span></div>
<div class="txt" style="position:absolute; left:497px; top:45647px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">programming</span></div>
<img id="background" style="position:absolute; left:0px; top:46421px;" width="1440" height="1080" src="page40.png"> <img id="background" style="position:absolute; left:1440px; top:46421px;" width="1440" height="1080" src="page-000040.png">
<div class="txt" style="position:absolute; left:804px; top:46439px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:46528px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Techniques for defensive programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:46668px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Protecting programs from invalid inputs</span></div>
<div class="txt" style="position:absolute; left:76px; top:46740px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Assertions see 7.3</span></div>
<div class="txt" style="position:absolute; left:76px; top:46812px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Exceptions see 7.2</span></div>
<div class="txt" style="position:absolute; left:76px; top:46884px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Specific error handling techniques see 7.2</span></div>
<div class="txt" style="position:absolute; left:76px; top:46956px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Barricade</span></div>
<div class="txt" style="position:absolute; left:76px; top:47028px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging aids</span></div>
<div class="txt" style="position:absolute; left:76px; top:47172px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The best form of defensive coding is not inserting errors in the</span></div>
<div class="txt" style="position:absolute; left:112px; top:47222px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">first place.</span></div>
<div class="txt" style="position:absolute; left:76px; top:47292px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">You can use defensive programming in combination with the other</span></div>
<div class="txt" style="position:absolute; left:112px; top:47342px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">techniques.</span></div>
<img id="background" style="position:absolute; left:0px; top:47610px;" width="1440" height="1080" src="page41.png"> <img id="background" style="position:absolute; left:1440px; top:47610px;" width="1440" height="1080" src="page-000041.png">
<div class="txt" style="position:absolute; left:804px; top:47628px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:47717px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(1) Protecting Programs From Invalid Inputs</span></div>
<div class="txt" style="position:absolute; left:76px; top:47857px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">“Garbage in, Garbage out.”</span></div>
<div class="txt" style="position:absolute; left:112px; top:47924px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">That expression is essentially software development’s version of caveat</span></div>
<div class="txt" style="position:absolute; left:148px; top:47963px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">emptor: let the user beware. </span><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">让用户提高注意力，如果输入错误的数据，则</span></div>
<div class="txt" style="position:absolute; left:148px; top:48006px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">程序不保证输出结果的正确性</span></div>
<div class="txt" style="position:absolute; left:76px; top:48076px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">For production software, garbage in, garbage out isn’t good</span></div>
<div class="txt" style="position:absolute; left:112px; top:48126px;"><span id="f27" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">enough.</span></div>
<div class="txt" style="position:absolute; left:76px; top:48196px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f27" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">A good program never puts out garbage, regardless of what it takes</span></div>
<div class="txt" style="position:absolute; left:112px; top:48246px;"><span id="f27" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">in.</span></div>
<div class="txt" style="position:absolute; left:112px; top:48311px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">“garbage in, nothing out”</span></div>
<div class="txt" style="position:absolute; left:112px; top:48371px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">“garbage in, error message out”</span></div>
<div class="txt" style="position:absolute; left:112px; top:48432px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">“no garbage allowed in”</span></div>
<div class="txt" style="position:absolute; left:76px; top:48497px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">“Garbage in, garbage out” is the mark of a sloppy, non</span><span id="f27" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">-secure</span></div>
<div class="txt" style="position:absolute; left:112px; top:48547px;"><span id="f27" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">program.</span></div>
<img id="background" style="position:absolute; left:0px; top:48799px;" width="1440" height="1080" src="page42.png"> <img id="background" style="position:absolute; left:1440px; top:48799px;" width="1440" height="1080" src="page-000042.png">
<div class="txt" style="position:absolute; left:804px; top:48817px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:48906px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Protecting Programs From Invalid Inputs</span></div>
<div class="txt" style="position:absolute; left:76px; top:49046px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Check the values of all data from external sources</span></div>
<div class="txt" style="position:absolute; left:112px; top:49113px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">When getting data from a file, a user, the network, or some other external</span></div>
<div class="txt" style="position:absolute; left:148px; top:49156px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">interface, check to be sure that the data falls within the allowable range.</span></div>
<div class="txt" style="position:absolute; left:76px; top:49222px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Examples:</span></div>
<div class="txt" style="position:absolute; left:112px; top:49288px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Make sure that numeric values are within tolerances and that strings are</span></div>
<div class="txt" style="position:absolute; left:148px; top:49332px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">short enough to handle.</span></div>
<div class="txt" style="position:absolute; left:112px; top:49392px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If a string is intended to represent a restricted range of values (such as a</span></div>
<div class="txt" style="position:absolute; left:148px; top:49435px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">financial transaction ID or something similar), be sure that the string is</span></div>
<div class="txt" style="position:absolute; left:148px; top:49479px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">valid for its intended purpose; otherwise reject it.</span></div>
<div class="txt" style="position:absolute; left:112px; top:49539px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f29" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If you’re working on a secure application, be especially leery of data that</span></div>
<div class="txt" style="position:absolute; left:148px; top:49582px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">might attack your system: attempted buffer overflows, injected SQL</span></div>
<div class="txt" style="position:absolute; left:148px; top:49625px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">commands, injected html or XML code, integer overflows, and so on.</span></div>
<img id="background" style="position:absolute; left:0px; top:49988px;" width="1440" height="1080" src="page43.png"> <img id="background" style="position:absolute; left:1440px; top:49988px;" width="1440" height="1080" src="page-000043.png">
<div class="txt" style="position:absolute; left:804px; top:50006px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:50095px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Protecting Programs From Invalid Inputs</span></div>
<div class="txt" style="position:absolute; left:76px; top:50235px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Check the values of all routine input parameters</span></div>
<div class="txt" style="position:absolute; left:112px; top:50302px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Checking the values of routine input parameters is essentially the same as</span></div>
<div class="txt" style="position:absolute; left:148px; top:50345px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">checking data that comes from an external source, except that the data</span></div>
<div class="txt" style="position:absolute; left:148px; top:50388px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">comes from another routine instead of from an external interface.</span></div>
<div class="txt" style="position:absolute; left:76px; top:50454px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Decide how to handle bad inputs</span></div>
<div class="txt" style="position:absolute; left:112px; top:50521px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f23" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Once you’ve detected an invalid parameter, what do you do with it?</span></div>
<div class="txt" style="position:absolute; left:148px; top:50564px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Depending on the situation, you might choose any of a dozen different</span></div>
<div class="txt" style="position:absolute; left:148px; top:50607px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">approaches, which are described in detail later in this chapter.</span></div>
<img id="background" style="position:absolute; left:0px; top:51177px;" width="1440" height="1080" src="page44.png"> <img id="background" style="position:absolute; left:1440px; top:51177px;" width="1440" height="1080" src="page-000044.png">
<div class="txt" style="position:absolute; left:33px; top:51279px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(2) Barricade </span><span id="f11" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">隔栏</span></div>
<div class="txt" style="position:absolute; left:804px; top:51195px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:51421px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Barricades are a damage-containment strategy. </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">隔栏是一种容损策略</span></div>
<div class="txt" style="position:absolute; left:112px; top:51491px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">The reason is similar to that for having isolated compartments in the hull</span></div>
<div class="txt" style="position:absolute; left:148px; top:51533px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">of a ship and firewalls in a building. </span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">起到防火墙的作用</span></div>
<div class="txt" style="position:absolute; left:76px; top:51605px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">One way to barricade for defensive programming purposes is to</span></div>
<div class="txt" style="position:absolute; left:112px; top:51655px;"><span id="f30" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">designate certain interfaces as boundaries to “safe” areas. Check</span></div>
<div class="txt" style="position:absolute; left:112px; top:51703px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">data crossing the boundaries of a safe area for validity and respond</span></div>
<div class="txt" style="position:absolute; left:112px; top:51751px;"><span id="f30" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">sensibly if the data isn’t valid.</span></div>
<div class="txt" style="position:absolute; left:870px; top:51909px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Defining some parts of the software</span></div>
<div class="txt" style="position:absolute; left:878px; top:51948px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">that work with dirty data and some</span></div>
<div class="txt" style="position:absolute; left:906px; top:51986px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">that work with clean can be an</span></div>
<div class="txt" style="position:absolute; left:873px; top:52024px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">effective way to relieve the majority</span></div>
<div class="txt" style="position:absolute; left:878px; top:52063px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">of the code of the responsibility for</span></div>
<div class="txt" style="position:absolute; left:964px; top:52101px;"><span id="f35" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">checking for bad data.</span></div>
<img id="background" style="position:absolute; left:0px; top:52366px;" width="1440" height="1080" src="page45.png"> <img id="background" style="position:absolute; left:1440px; top:52366px;" width="1440" height="1080" src="page-000045.png">
<div class="txt" style="position:absolute; left:33px; top:52473px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Barricade</span></div>
<div class="txt" style="position:absolute; left:804px; top:52384px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:79px; top:52593px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The class’s public methods assume the data is unsafe, and they are</span></div>
<div class="txt" style="position:absolute; left:115px; top:52643px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">responsible for checking the data and sanitizing it. Once the data</span></div>
<div class="txt" style="position:absolute; left:115px; top:52691px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">has been accepted by the class’s public methods, the class’s private</span></div>
<div class="txt" style="position:absolute; left:115px; top:52735px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">methods can assume the data is safe. </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">类的</span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">public</span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">方法中假设数据是</span></div>
<div class="txt" style="position:absolute; left:115px; top:52783px;"><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不安全的，他们负责检查和清洗；</span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">private</span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">方法则认为被公有方法接收</span></div>
<div class="txt" style="position:absolute; left:115px; top:52831px;"><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">处理后的数据是安全的。</span></div>
<div class="txt" style="position:absolute; left:79px; top:52905px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Another way of thinking about this approach is as an operating-</span></div>
<div class="txt" style="position:absolute; left:115px; top:52951px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">room technique. </span><span id="f20" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">类似于手术室管理，进入之前消毒，之后认为安全</span></div>
<div class="txt" style="position:absolute; left:115px; top:53020px;"><span id="f40" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f42" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Data is sterilized before it’s allowed to enter the operating room. Anything</span></div>
<div class="txt" style="position:absolute; left:151px; top:53064px;"><span id="f42" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">that’s in the operating room is assumed to be safe.</span></div>
<div class="txt" style="position:absolute; left:115px; top:53124px;"><span id="f40" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">The key design decision is deciding what to put in the operating room,</span></div>
<div class="txt" style="position:absolute; left:151px; top:53167px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">what to keep out, and where to put the doors</span><span id="f42" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">—</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">which routines are</span></div>
<div class="txt" style="position:absolute; left:151px; top:53210px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">considered to be inside the safety zone, which are outside, and which</span></div>
<div class="txt" style="position:absolute; left:151px; top:53254px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">sanitize the data.</span></div>
<div class="txt" style="position:absolute; left:115px; top:53314px;"><span id="f40" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">The easiest way to do this is usually by sanitizing external data as it</span></div>
<div class="txt" style="position:absolute; left:151px; top:53357px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">arrives, but data often needs to be sanitized at more than one level, so</span></div>
<div class="txt" style="position:absolute; left:151px; top:53401px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">multiple levels of sterilization are sometimes required.</span></div>
<img id="background" style="position:absolute; left:0px; top:53555px;" width="1440" height="1080" src="page46.png"> <img id="background" style="position:absolute; left:1440px; top:53555px;" width="1440" height="1080" src="page-000046.png">
<div class="txt" style="position:absolute; left:33px; top:53662px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Barricade</span></div>
<div class="txt" style="position:absolute; left:804px; top:53573px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:53802px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Convert input data to the proper type at input time</span></div>
<div class="txt" style="position:absolute; left:112px; top:53869px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Input typically arrives in the form of a string or number.</span></div>
<div class="txt" style="position:absolute; left:112px; top:53929px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Sometimes the value will map onto a boolean </span><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">type like “yes” or “no.”</span></div>
<div class="txt" style="position:absolute; left:112px; top:53990px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Sometimes the value will map onto an enumerated type like Color_Red,</span></div>
<div class="txt" style="position:absolute; left:148px; top:54033px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Color_Green, and Color_Blue.</span></div>
<div class="txt" style="position:absolute; left:112px; top:54093px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Carrying data of questionable type for any length of time in a program</span></div>
<div class="txt" style="position:absolute; left:148px; top:54137px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">increases complexity and increases the chance that someone can crash</span></div>
<div class="txt" style="position:absolute; left:148px; top:54180px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">your program by inputting a color like “Yes.”</span></div>
<div class="txt" style="position:absolute; left:112px; top:54240px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Convert input data to the proper form as soon as possible after it’s input.</span></div>
<img id="background" style="position:absolute; left:0px; top:54744px;" width="1440" height="1080" src="page47.png"> <img id="background" style="position:absolute; left:1440px; top:54744px;" width="1440" height="1080" src="page-000047.png">
<div class="txt" style="position:absolute; left:804px; top:54762px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:54851px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Relationship between Barricades and Assertions</span></div>
<div class="txt" style="position:absolute; left:76px; top:54991px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">The use of barricades makes the distinction between assertions</span></div>
<div class="txt" style="position:absolute; left:112px; top:55039px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">and error handling clean cut. </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">隔栏的实现中可以体现断言和异常的区别</span></div>
<div class="txt" style="position:absolute; left:112px; top:55106px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Routines that are outside the barricade should use error handling</span></div>
<div class="txt" style="position:absolute; left:148px; top:55149px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">because it isn’t safe to make any assumptions about the data.</span></div>
<div class="txt" style="position:absolute; left:112px; top:55209px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Routines inside the barricade should use assertions</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">, because the data</span></div>
<div class="txt" style="position:absolute; left:148px; top:55253px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">passed to them is supposed to be sanitized before it’s passed across the</span></div>
<div class="txt" style="position:absolute; left:148px; top:55296px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">barricade. If one of the routines inside the barricade detects bad data,</span></div>
<div class="txt" style="position:absolute; left:148px; top:55339px;"><span id="f22" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">that’s an error in the program rather than an error in the data.</span></div>
<div class="txt" style="position:absolute; left:76px; top:55477px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">The use of barricades also illustrates the value of deciding at the</span></div>
<div class="txt" style="position:absolute; left:112px; top:55526px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">architectural level how to handle errors. Deciding which code is</span></div>
<div class="txt" style="position:absolute; left:112px; top:55574px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">inside and which is outside the barricade is an architecture-level</span></div>
<div class="txt" style="position:absolute; left:112px; top:55621px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">decision. </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">隔栏的使用也展示了在架构级别如何处理错误，决定哪些代码位于</span></div>
<div class="txt" style="position:absolute; left:112px; top:55666px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">内部，哪些位于隔栏之外是架构级决策。</span></div>
<img id="background" style="position:absolute; left:0px; top:55933px;" width="1440" height="1080" src="page48.png"> <img id="background" style="position:absolute; left:1440px; top:55933px;" width="1440" height="1080" src="page-000048.png">
<div class="txt" style="position:absolute; left:804px; top:55951px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:56035px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(3) Debugging Aids </span><span id="f11" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">调试助手</span><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">/</span><span id="f11" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">辅助调试的代码</span></div>
<div class="txt" style="position:absolute; left:76px; top:56180px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging aids is a key aspect of defensive programming for</span></div>
<div class="txt" style="position:absolute; left:112px; top:56230px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">quickly detecting errors. (See 7.4 debugging)</span></div>
<div class="txt" style="position:absolute; left:76px; top:56300px;"><span id="f15" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f21" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Don’t Automatically Apply Production Constraints to the</span></div>
<div class="txt" style="position:absolute; left:112px; top:56345px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Development Version. </span><span id="f25" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不要把产品版的限制强加于开发版之上</span></div>
<div class="txt" style="position:absolute; left:112px; top:56415px;"><span id="f27" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">A common programmer blind spot is the assumption that limitations of</span></div>
<div class="txt" style="position:absolute; left:148px; top:56458px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the production software apply to the development version.</span></div>
<div class="txt" style="position:absolute; left:291px; top:56520px;"><span id="f17" style="font-size:31px;vertical-align:baseline;color:rgba(255,255,255,1);">production version</span></div>
<div class="txt" style="position:absolute; left:329px; top:56573px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">has to run fast</span></div>
<div class="txt" style="position:absolute; left:212px; top:56626px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">has to be stingy with resources</span></div>
<div class="txt" style="position:absolute; left:334px; top:56661px;"><span id="f25" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">节约使用资源</span></div>
<div class="txt" style="position:absolute; left:230px; top:56717px;"><span id="f49" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">shouldn’t expose dangerous</span></div>
<div class="txt" style="position:absolute; left:276px; top:56756px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">operations to the user</span></div>
<div class="txt" style="position:absolute; left:872px; top:56520px;"><span id="f17" style="font-size:31px;vertical-align:baseline;color:rgba(255,255,255,1);">development version</span></div>
<div class="txt" style="position:absolute; left:845px; top:56573px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">might be able to run slow</span></div>
<div class="txt" style="position:absolute; left:786px; top:56626px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">might be allowed to use resources</span></div>
<div class="txt" style="position:absolute; left:797px; top:56661px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">extravagantly </span><span id="f25" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">可奢侈地使用资源</span></div>
<div class="txt" style="position:absolute; left:725px; top:56717px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">can have extra operations that you can use</span></div>
<div class="txt" style="position:absolute; left:886px; top:56756px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">without a safety net</span></div>
<div class="txt" style="position:absolute; left:112px; top:56821px;"><span id="f27" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Be willing to trade speed and resource usage during development in</span></div>
<div class="txt" style="position:absolute; left:148px; top:56864px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">exchange for built-in tools that can make development go more smoothly.</span></div>
<div class="txt" style="position:absolute; left:148px; top:56906px;"><span id="f25" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">在开发过程中牺牲速度和对资源的使用，以换取可以使开发更顺利的内置</span></div>
<div class="txt" style="position:absolute; left:148px; top:56947px;"><span id="f25" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">工具。</span></div>
<img id="background" style="position:absolute; left:0px; top:57122px;" width="1440" height="1080" src="page49.png"> <img id="background" style="position:absolute; left:1440px; top:57122px;" width="1440" height="1080" src="page-000049.png">
<div class="txt" style="position:absolute; left:33px; top:57229px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids</span></div>
<div class="txt" style="position:absolute; left:804px; top:57140px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:57369px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Introduce Debugging Aids Early.</span></div>
<div class="txt" style="position:absolute; left:112px; top:57436px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">The earlier you introduce debugging aids, the more they’ll help.</span></div>
<div class="txt" style="position:absolute; left:112px; top:57496px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Typically, you won’t go to the effort of writing a debugging aid until after</span></div>
<div class="txt" style="position:absolute; left:148px; top:57539px;"><span id="f17" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">you’ve been bitten by a problem several times.</span></div>
<div class="txt" style="position:absolute; left:112px; top:57600px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If you write the aid after the first time, however, or use one from a</span></div>
<div class="txt" style="position:absolute; left:148px; top:57643px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">previous project, it will help throughout the project.</span></div>
<img id="background" style="position:absolute; left:0px; top:58311px;" width="1440" height="1080" src="page50.png"> <img id="background" style="position:absolute; left:1440px; top:58311px;" width="1440" height="1080" src="page-000050.png">
<div class="txt" style="position:absolute; left:804px; top:58329px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:58418px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids: Use Offensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:58555px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Use Offensive Programming </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">使用进攻式编程</span></div>
<div class="txt" style="position:absolute; left:112px; top:58625px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Exceptional cases should be handled in a way that makes them obvious</span></div>
<div class="txt" style="position:absolute; left:148px; top:58668px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">during development and recoverable when production code is running.</span></div>
<div class="txt" style="position:absolute; left:148px; top:58707px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">(Howard and LeBlanc 2003). </span><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">对异常的处理：在开发阶段让异常尽可能明</span></div>
<div class="txt" style="position:absolute; left:148px; top:58751px;"><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">显的展示出来，而在产品运行时让异常能够自我恢复。 </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">--</span><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">进攻式编程</span></div>
<div class="txt" style="position:absolute; left:112px; top:58814px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">E.g., Suppose you have a </span><span id="f33" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">case </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">statement that you expect to handle only</span></div>
<div class="txt" style="position:absolute; left:148px; top:58858px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">five kinds of events.</span></div>
<div class="txt" style="position:absolute; left:148px; top:58915px;"><span id="f37" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">During development, the default case should be used to generate a warning that</span></div>
<div class="txt" style="position:absolute; left:184px; top:58953px;"><span id="f37" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">says “Hey! There’s another case here! Fix the program!”</span></div>
<div class="txt" style="position:absolute; left:148px; top:58999px;"><span id="f37" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">During production, however, the default case should do something more</span></div>
<div class="txt" style="position:absolute; left:184px; top:59038px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">graceful, like writing a message to an error-log file.</span></div>
<img id="background" style="position:absolute; left:0px; top:59500px;" width="1440" height="1080" src="page51.png"> <img id="background" style="position:absolute; left:1440px; top:59500px;" width="1440" height="1080" src="page-000051.png">
<div class="txt" style="position:absolute; left:804px; top:59518px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:59607px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids: Use Offensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:59744px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Some ways you can program offensively: </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">尽可能使程序失败</span></div>
<div class="txt" style="position:absolute; left:112px; top:59814px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Make sure asserts abort the program. Don’t allow programmers to get into</span></div>
<div class="txt" style="position:absolute; left:148px; top:59857px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the habit of just hitting the ENTER key to bypass a known problem. Make</span></div>
<div class="txt" style="position:absolute; left:148px; top:59900px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">the problem painful enough that it will be fixed.</span></div>
<div class="txt" style="position:absolute; left:112px; top:59961px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Completely fill any memory allocated so that you can detect memory</span></div>
<div class="txt" style="position:absolute; left:148px; top:60004px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">allocation errors.</span></div>
<div class="txt" style="position:absolute; left:112px; top:60064px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Completely fill any files or streams allocated to flush out any file-format</span></div>
<div class="txt" style="position:absolute; left:148px; top:60107px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">errors.</span></div>
<div class="txt" style="position:absolute; left:112px; top:60168px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Be sure the code in each case statement’s else clause fails hard (aborts the</span></div>
<div class="txt" style="position:absolute; left:148px; top:60211px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">program) or is otherwise impossible to overlook.</span></div>
<div class="txt" style="position:absolute; left:112px; top:60272px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Fill an object with junk data just before it’s deleted</span></div>
<div class="txt" style="position:absolute; left:76px; top:60337px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Sometimes </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">the best defense is a good offense.</span></div>
<div class="txt" style="position:absolute; left:76px; top:60409px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Fail hard during development so that you can fail softer during</span></div>
<div class="txt" style="position:absolute; left:112px; top:60455px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">production. </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">开发时失败地越严重，发布后失败地越轻微。</span></div>
<img id="background" style="position:absolute; left:0px; top:60689px;" width="1440" height="1080" src="page52.png"> <img id="background" style="position:absolute; left:1440px; top:60689px;" width="1440" height="1080" src="page-000052.png">
<div class="txt" style="position:absolute; left:804px; top:60707px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:60796px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids: Plan to Remove Debugging Aids</span></div>
<div class="txt" style="position:absolute; left:76px; top:60936px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">In commercial software, leaving all the debugging code in the</span></div>
<div class="txt" style="position:absolute; left:112px; top:60986px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">program will cause that the performance penalty in size and speed</span></div>
<div class="txt" style="position:absolute; left:112px; top:61034px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">can be prohibitive. Plan to avoid shuffling debugging code in and</span></div>
<div class="txt" style="position:absolute; left:112px; top:61077px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">out of a program. </span><span id="f19" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">做好计划，避免调试用代码和程序代码纠缠不清。</span></div>
<div class="txt" style="position:absolute; left:112px; top:61147px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Use version control and build tools like make</span></div>
<div class="txt" style="position:absolute; left:148px; top:61203px;"><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Version-control and build tools(like git, svn</span><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">, ant, make…) can build different</span></div>
<div class="txt" style="position:absolute; left:184px; top:61242px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">versions of a program from the same source files.</span></div>
<div class="txt" style="position:absolute; left:148px; top:61288px;"><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">In development mode, you can set the build tool to include all the debug code.</span></div>
<div class="txt" style="position:absolute; left:148px; top:61334px;"><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">In production mode, you can set it to exclude any debug code you don’t want in</span></div>
<div class="txt" style="position:absolute; left:184px; top:61372px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">the commercial version.</span></div>
<div class="txt" style="position:absolute; left:112px; top:61423px;"><span id="f21" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">Use a built-in preprocessor</span></div>
<div class="txt" style="position:absolute; left:148px; top:61479px;"><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">If your programming environment has a preprocessor</span><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">—</span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">as C++ does, for</span></div>
<div class="txt" style="position:absolute; left:184px; top:61517px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">example</span><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">—</span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">you can include or exclude debug code at the flick of a compiler</span></div>
<div class="txt" style="position:absolute; left:184px; top:61556px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">switch.</span></div>
<div class="txt" style="position:absolute; left:148px; top:61602px;"><span id="f24" style="font-size:31px;vertical-align:baseline;color:rgba(255,130,44,1);">• </span><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">You can use the preprocessor directly or by writing a macro that works with</span></div>
<div class="txt" style="position:absolute; left:184px; top:61640px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">preprocessor definitions.</span></div>
<img id="background" style="position:absolute; left:0px; top:61878px;" width="1440" height="1080" src="page53.png"> <img id="background" style="position:absolute; left:1440px; top:61878px;" width="1440" height="1080" src="page-000053.png">
<div class="txt" style="position:absolute; left:804px; top:61896px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:61985px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids: Plan to Remove Debugging Aids</span></div>
<div class="txt" style="position:absolute; left:76px; top:62125px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Write your own preprocessor</span></div>
<div class="txt" style="position:absolute; left:76px; top:62197px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If a language doesn’t include a preprocessor, it’s fairly easy to write</span></div>
<div class="txt" style="position:absolute; left:112px; top:62247px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">one for including and excluding debug code.</span></div>
<div class="txt" style="position:absolute; left:112px; top:62312px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Establish a convention for designating debug code and write your</span></div>
<div class="txt" style="position:absolute; left:148px; top:62355px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">precompiler to follow that convention.</span></div>
<div class="txt" style="position:absolute; left:112px; top:62415px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">For example, in Java you could write a precompiler to respond to the</span></div>
<div class="txt" style="position:absolute; left:148px; top:62459px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">keywords //#BEGIN DEBUG and //#END DEBUG.</span></div>
<div class="txt" style="position:absolute; left:112px; top:62519px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Write a script to call the preprocessor, and then compile the processed</span></div>
<div class="txt" style="position:absolute; left:148px; top:62562px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">code.</span></div>
<div class="txt" style="position:absolute; left:112px; top:62623px;"><span id="f19" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f33" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">You’ll save time in the long run, and you won’t mistakenly compile the</span></div>
<div class="txt" style="position:absolute; left:148px; top:62666px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">unpreprocessed code.</span></div>
<img id="background" style="position:absolute; left:0px; top:63067px;" width="1440" height="1080" src="page54.png"> <img id="background" style="position:absolute; left:1440px; top:63067px;" width="1440" height="1080" src="page-000054.png">
<div class="txt" style="position:absolute; left:804px; top:63085px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:63174px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Debugging Aids: Plan to Remove Debugging Aids</span></div>
<div class="txt" style="position:absolute; left:54px; top:63302px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Use debugging stubs</span><span id="f16" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">使用调试存根</span></div>
<div class="txt" style="position:absolute; left:90px; top:63369px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">In many instances, you can call a routine to do debugging checks.</span></div>
<div class="txt" style="position:absolute; left:90px; top:63430px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">During development, the routine might perform several operations before</span></div>
<div class="txt" style="position:absolute; left:126px; top:63473px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">control returns to the caller.</span></div>
<div class="txt" style="position:absolute; left:90px; top:63534px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">For production code, you can replace the complicated routine with a stub</span></div>
<div class="txt" style="position:absolute; left:126px; top:63577px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">routine that merely returns control immediately to the caller or performs</span></div>
<div class="txt" style="position:absolute; left:126px; top:63620px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">only a couple of quick operations before returning control.</span></div>
<div class="txt" style="position:absolute; left:90px; top:63681px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f29" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">This approach incurs only a small performance penalty, and it’s a quicker</span></div>
<div class="txt" style="position:absolute; left:126px; top:63724px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">solution than writing your own preprocessor. Keep both the development</span></div>
<div class="txt" style="position:absolute; left:126px; top:63767px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">and production versions of the routines so that you can switch back and</span></div>
<div class="txt" style="position:absolute; left:126px; top:63810px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">forth during future development and production.</span></div>
<div class="txt" style="position:absolute; left:54px; top:63876px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(255,0,0,1);">// check object passed in during development</span></div>
<div class="txt" style="position:absolute; left:54px; top:63919px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">void checkObject(someClass XXX){</span></div>
<div class="txt" style="position:absolute; left:100px; top:63963px;"><span id="f41" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,0,1);">…//check whether null</span></div>
<div class="txt" style="position:absolute; left:750px; top:63968px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,255,1);">// check object passed in during production</span></div>
<div class="txt" style="position:absolute; left:100px; top:64007px;"><span id="f41" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,0,1);">…//check data format</span></div>
<div class="txt" style="position:absolute; left:750px; top:64012px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">void checkObject(someClass XXX){</span></div>
<div class="txt" style="position:absolute; left:100px; top:64050px;"><span id="f41" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,0,1);">…</span></div>
<div class="txt" style="position:absolute; left:750px; top:64056px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">// no code; just return to caller</span></div>
<div class="txt" style="position:absolute; left:100px; top:64094px;"><span id="f41" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,0,1);">…//check data integrality }</span></div>
<div class="txt" style="position:absolute; left:750px; top:64100px;"><span id="f34" style="font-size:12px;vertical-align:baseline;color:rgba(0,0,0,1);">}</span></div>
<img id="background" style="position:absolute; left:0px; top:64256px;" width="1440" height="1080" src="page55.png"> <img id="background" style="position:absolute; left:1440px; top:64256px;" width="1440" height="1080" src="page-000055.png">
<div class="txt" style="position:absolute; left:804px; top:64274px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:64339px;"><span id="f8" style="font-size:48px;vertical-align:baseline;color:rgba(0,0,0,1);">Determining How Much Defensive Programming to Leave in</span></div>
<div class="txt" style="position:absolute; left:87px; top:64396px;"><span id="f8" style="font-size:48px;vertical-align:baseline;color:rgba(0,0,0,1);">Production Code?</span></div>
<div class="txt" style="position:absolute; left:76px; top:64503px;"><span id="f12" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">One of the paradoxes of defensive programming is that during</span></div>
<div class="txt" style="position:absolute; left:112px; top:64553px;"><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">development, you’d like an error to be noticeable.</span></div>
<div class="txt" style="position:absolute; left:76px; top:64623px;"><span id="f12" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f16" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">But during production, you’d rather have the error be as</span></div>
<div class="txt" style="position:absolute; left:112px; top:64673px;"><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">unobtrusive as possible, to have the program recover or fail</span></div>
<div class="txt" style="position:absolute; left:112px; top:64716px;"><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">gracefully. </span><span id="f25" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">开发中，希望错误尽可能明显；发布后，希望错误尽可能</span></div>
<div class="txt" style="position:absolute; left:112px; top:64764px;"><span id="f25" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">不明显。</span></div>
<div class="txt" style="position:absolute; left:76px; top:64911px;"><span id="f12" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">Some guidelines for deciding which defensive programming tools</span></div>
<div class="txt" style="position:absolute; left:112px; top:64961px;"><span id="f14" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">to leave in your production code and which to leave out:</span></div>
<img id="background" style="position:absolute; left:0px; top:65445px;" width="1440" height="1080" src="page56.png"> <img id="background" style="position:absolute; left:1440px; top:65445px;" width="1440" height="1080" src="page-000056.png">
<div class="txt" style="position:absolute; left:804px; top:65463px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:65552px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(1) Leave in code that checks for important errors</span></div>
<div class="txt" style="position:absolute; left:76px; top:65692px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Decide which areas of the program can afford to have undetected</span></div>
<div class="txt" style="position:absolute; left:112px; top:65737px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">errors and which areas cannot. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">确定程序的哪些部分能够承受未检测</span></div>
<div class="txt" style="position:absolute; left:112px; top:65785px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">出错误而造成的后果，哪些不能。</span></div>
<div class="txt" style="position:absolute; left:76px; top:65860px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">E.g., in a spreadsheet program, undetected errors in the screen-</span></div>
<div class="txt" style="position:absolute; left:112px; top:65910px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">update area of the program may be affordable, but undetected</span></div>
<div class="txt" style="position:absolute; left:112px; top:65958px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">errors in the calculation engine is unaffordable.</span></div>
<img id="background" style="position:absolute; left:0px; top:66634px;" width="1440" height="1080" src="page57.png"> <img id="background" style="position:absolute; left:1440px; top:66634px;" width="1440" height="1080" src="page-000057.png">
<div class="txt" style="position:absolute; left:804px; top:66652px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:66741px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(2) Remove code that checks for trivial errors</span></div>
<div class="txt" style="position:absolute; left:76px; top:66881px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If an error has truly trivial consequences, remove code that checks</span></div>
<div class="txt" style="position:absolute; left:112px; top:66926px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">for it. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">如果错误的后果微不足道，可以删除检测代码。</span></div>
<div class="txt" style="position:absolute; left:76px; top:67001px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">In the previous example, you might remove the code that checks</span></div>
<div class="txt" style="position:absolute; left:112px; top:67051px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">the spreadsheet screen update.</span></div>
<div class="txt" style="position:absolute; left:76px; top:67121px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">“Remove” doesn’t mean physically remove the code. </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">It means use</span></div>
<div class="txt" style="position:absolute; left:112px; top:67171px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">version control, precompiler switches, or some other technique to</span></div>
<div class="txt" style="position:absolute; left:112px; top:67214px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">compile the program without that particular code. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">并不是物理删除</span></div>
<div class="txt" style="position:absolute; left:112px; top:67262px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">，要利用版本控制或者</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">make</span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">工具</span></div>
<div class="txt" style="position:absolute; left:76px; top:67337px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f23" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If space isn’t a problem, you could leave in the error</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">-checking code</span></div>
<div class="txt" style="position:absolute; left:112px; top:67387px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">but have it log messages to an error-log file unobtrusively.</span></div>
<img id="background" style="position:absolute; left:0px; top:67823px;" width="1440" height="1080" src="page58.png"> <img id="background" style="position:absolute; left:1440px; top:67823px;" width="1440" height="1080" src="page-000058.png">
<div class="txt" style="position:absolute; left:804px; top:67841px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:67930px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(3) Remove code that results in hard crashes</span></div>
<div class="txt" style="position:absolute; left:76px; top:68070px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If your program contains debugging code that could cause a loss of</span></div>
<div class="txt" style="position:absolute; left:112px; top:68115px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">data, take it out of the production version. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">会造成严重错误的调试代</span></div>
<div class="txt" style="position:absolute; left:112px; top:68163px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">码</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">(</span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">如数据丢失</span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">)</span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">，应该被移除</span></div>
<div class="txt" style="position:absolute; left:76px; top:68238px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f30" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">During development, when your program detects an error, you’d</span></div>
<div class="txt" style="position:absolute; left:112px; top:68288px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">like the error to be as noticeable as possible so that you can fix it.</span></div>
<div class="txt" style="position:absolute; left:112px; top:68353px;"><span id="f33" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Often, the best way to accomplish such a goal is to have the program print</span></div>
<div class="txt" style="position:absolute; left:148px; top:68396px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">a debugging message and crash when it detects an error.</span></div>
<div class="txt" style="position:absolute; left:112px; top:68456px;"><span id="f33" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">This is useful even for minor errors.</span></div>
<div class="txt" style="position:absolute; left:76px; top:68522px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">During production, your users need a chance to save their work</span></div>
<div class="txt" style="position:absolute; left:112px; top:68572px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">before the program crashes and are probably willing to tolerate a</span></div>
<div class="txt" style="position:absolute; left:112px; top:68620px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">few anomalies in exchange for keeping the program going long</span></div>
<div class="txt" style="position:absolute; left:112px; top:68668px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">enough for them to do that.</span></div>
<div class="txt" style="position:absolute; left:112px; top:68733px;"><span id="f33" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f45" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Users don’t appreciate anything that results in the loss of their work,</span></div>
<div class="txt" style="position:absolute; left:148px; top:68776px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">regardless of how much it helps debugging and ultimately improves the</span></div>
<div class="txt" style="position:absolute; left:148px; top:68819px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">quality of the program.</span></div>
<img id="background" style="position:absolute; left:0px; top:69012px;" width="1440" height="1080" src="page59.png"> <img id="background" style="position:absolute; left:1440px; top:69012px;" width="1440" height="1080" src="page-000059.png">
<div class="txt" style="position:absolute; left:804px; top:69030px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:69119px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(4) Leave in code that helps crash gracefully</span></div>
<div class="txt" style="position:absolute; left:76px; top:69259px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">If your program contains debugging code that detects potentially</span></div>
<div class="txt" style="position:absolute; left:112px; top:69309px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">fatal errors, leave the code in that allows the program to crash</span></div>
<div class="txt" style="position:absolute; left:112px; top:69352px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">gracefully. </span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">如果程序包含检测潜在致命错误的调试代码，可将这些调</span></div>
<div class="txt" style="position:absolute; left:112px; top:69400px;"><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,255,1);">试代码保留，以使程序稳妥的崩溃。</span></div>
<div class="txt" style="position:absolute; left:76px; top:69472px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">E.g.</span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">，</span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">in the Mars Pathfinder</span><span id="f17" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">火星探路者</span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">, for example, engineers left</span></div>
<div class="txt" style="position:absolute; left:112px; top:69525px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">some of the debug code in by design. An error occurred after the</span></div>
<div class="txt" style="position:absolute; left:112px; top:69573px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Pathfinder had landed.</span></div>
<div class="txt" style="position:absolute; left:76px; top:69643px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">By using the debug aids that had been left in, engineers at JPL were</span></div>
<div class="txt" style="position:absolute; left:112px; top:69693px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">able to diagnose the problem and upload revised code to the</span></div>
<div class="txt" style="position:absolute; left:112px; top:69741px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Pathfinder, and the Pathfinder completed its mission perfectly</span></div>
<div class="txt" style="position:absolute; left:112px; top:69789px;"><span id="f8" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">(March 1999).</span></div>
<img id="background" style="position:absolute; left:0px; top:70201px;" width="1440" height="1080" src="page60.png"> <img id="background" style="position:absolute; left:1440px; top:70201px;" width="1440" height="1080" src="page-000060.png">
<div class="txt" style="position:absolute; left:804px; top:70219px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:70308px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">(5)(6) Log errors and friendly error messages</span></div>
<div class="txt" style="position:absolute; left:76px; top:70448px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">5. Log errors for your technical support personnel</span></div>
<div class="txt" style="position:absolute; left:112px; top:70515px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Consider leaving debugging aids in the production code but changing</span></div>
<div class="txt" style="position:absolute; left:148px; top:70558px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">their behavior so that it’s appropriate for the production version.</span></div>
<div class="txt" style="position:absolute; left:112px; top:70618px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If you’ve loaded your code with assertions that halt the program during</span></div>
<div class="txt" style="position:absolute; left:148px; top:70662px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">development, you might considering changing the assertion routine to log</span></div>
<div class="txt" style="position:absolute; left:148px; top:70705px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">messages to a file during production rather than eliminating them</span></div>
<div class="txt" style="position:absolute; left:148px; top:70744px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">altogether.</span><span id="f26" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">考虑在产品代码中留下调试代码，但改变他们的行为，以便适合</span></div>
<div class="txt" style="position:absolute; left:148px; top:70787px;"><span id="f26" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,255,1);">生产版本。如在产品中禁用断言，但把断言转换为将消息记录入日志中。</span></div>
<div class="txt" style="position:absolute; left:76px; top:70917px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">6. See that the error messages you leave in are friendly</span></div>
<div class="txt" style="position:absolute; left:112px; top:70984px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">If you leave internal error messages in the program, verify that they’re in</span></div>
<div class="txt" style="position:absolute; left:148px; top:71027px;"><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">language that’s friendly to the user.</span></div>
<div class="txt" style="position:absolute; left:112px; top:71084px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f18" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">E.g., “You’ve got a bad pointer allocation!” </span><span id="f26" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">？？？</span></div>
<div class="txt" style="position:absolute; left:112px; top:71149px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f49" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">A common and effective approach is to notify the user of an “internal</span></div>
<div class="txt" style="position:absolute; left:148px; top:71192px;"><span id="f49" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">error” and list an email address or phone number the user can use to</span></div>
<div class="txt" style="position:absolute; left:148px; top:71235px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">report it.</span></div>
<img id="background" style="position:absolute; left:0px; top:71390px;" width="1440" height="1080" src="page61.png"> <img id="background" style="position:absolute; left:1440px; top:71390px;" width="1440" height="1080" src="page-000061.png">
<div class="txt" style="position:absolute; left:804px; top:71408px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:71497px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">Being Defensive about Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:71637px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Too much defensive programming creates problems of its own.</span></div>
<div class="txt" style="position:absolute; left:112px; top:71704px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Overly defensive programming however introduces unnecessary code for</span></div>
<div class="txt" style="position:absolute; left:148px; top:71747px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">errors impossible to even happen, </span><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">adds complexity to the software, thus</span></div>
<div class="txt" style="position:absolute; left:148px; top:71790px;"><span id="f13" style="font-size:36px;vertical-align:baseline;color:rgba(255,0,0,1);">wasting runtime and maintenance costs. </span><span id="f22" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,255,1);">增加了复杂性、运行时间和维护成本</span></div>
<div class="txt" style="position:absolute; left:112px; top:71851px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Code installed for defensive programming is not immune to defects, and</span></div>
<div class="txt" style="position:absolute; left:148px; top:71894px;"><span id="f26" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">you’re just as likely to find a defect in defensive</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">-programming code as in</span></div>
<div class="txt" style="position:absolute; left:148px; top:71937px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">any other code. </span><span id="f22" style="font-size:28px;vertical-align:baseline;color:rgba(0,0,255,1);">防御性代码本身也有可能存在缺陷</span></div>
<div class="txt" style="position:absolute; left:112px; top:71997px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">There is also the risk that the code traps or prevents too many exceptions,</span></div>
<div class="txt" style="position:absolute; left:148px; top:72041px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">potentially resulting in unnoticed, incorrect results.</span></div>
<div class="txt" style="position:absolute; left:76px; top:72178px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Think about where you need to be defensive, and set your</span></div>
<div class="txt" style="position:absolute; left:112px; top:72224px;"><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">defensive-programming priorities accordingly. </span><span id="f22" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">设计好何处进行防御</span></div>
<div class="txt" style="position:absolute; left:112px; top:72272px;"><span id="f22" style="font-size:40px;vertical-align:baseline;color:rgba(255,0,0,1);">，制定相应的防御策略</span></div>
<img id="background" style="position:absolute; left:0px; top:72579px;" width="1440" height="1080" src="page62.png"> <img id="background" style="position:absolute; left:1440px; top:72579px;" width="1440" height="1080" src="page-000062.png">
<div class="txt" style="position:absolute; left:804px; top:72597px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:72686px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">CHECKLIST: Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:72826px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">General</span></div>
<div class="txt" style="position:absolute; left:112px; top:72893px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does the routine protect itself from bad input data?</span></div>
<div class="txt" style="position:absolute; left:112px; top:72953px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have you used assertions to document assumptions, including</span></div>
<div class="txt" style="position:absolute; left:148px; top:72996px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">preconditions and postconditions?</span></div>
<div class="txt" style="position:absolute; left:112px; top:73057px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have assertions been used only to document conditions that should never</span></div>
<div class="txt" style="position:absolute; left:148px; top:73100px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">occur?</span></div>
<div class="txt" style="position:absolute; left:112px; top:73161px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does the architecture or high-level design specify a specific set of error</span></div>
<div class="txt" style="position:absolute; left:148px; top:73204px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">handling techniques?</span></div>
<div class="txt" style="position:absolute; left:112px; top:73264px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does the architecture or high-level design specify whether error handling</span></div>
<div class="txt" style="position:absolute; left:148px; top:73308px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">should favor robustness or correctness?</span></div>
<div class="txt" style="position:absolute; left:112px; top:73368px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have barricades been created to contain the damaging effect of errors and</span></div>
<div class="txt" style="position:absolute; left:148px; top:73411px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">reduce the amount of code that has to be concerned about error</span></div>
<div class="txt" style="position:absolute; left:148px; top:73454px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">processing?</span></div>
<div class="txt" style="position:absolute; left:112px; top:73511px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f41" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">摘自《代码大全》</span></div>
<img id="background" style="position:absolute; left:0px; top:73768px;" width="1440" height="1080" src="page63.png"> <img id="background" style="position:absolute; left:1440px; top:73768px;" width="1440" height="1080" src="page-000063.png">
<div class="txt" style="position:absolute; left:804px; top:73786px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:73875px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">CHECKLIST: Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:74015px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">General</span></div>
<div class="txt" style="position:absolute; left:112px; top:74082px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have debugging aids been used in the code?</span></div>
<div class="txt" style="position:absolute; left:112px; top:74142px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Has information hiding been used to contain the effects of changes so that</span></div>
<div class="txt" style="position:absolute; left:148px; top:74185px;"><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">they won’t affect code outside the routine or class that’s changed?</span></div>
<div class="txt" style="position:absolute; left:112px; top:74246px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have debugging aids been installed in such a way that they can be</span></div>
<div class="txt" style="position:absolute; left:148px; top:74289px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">activated or deactivated without a great deal of fuss?</span></div>
<div class="txt" style="position:absolute; left:112px; top:74350px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Is the amount of defensive programming code appropriate</span><span id="f20" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">—</span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">neither too</span></div>
<div class="txt" style="position:absolute; left:148px; top:74393px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">much nor too little?</span></div>
<div class="txt" style="position:absolute; left:112px; top:74453px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have you used offensive programming techniques to make errors difficult</span></div>
<div class="txt" style="position:absolute; left:148px; top:74497px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">to overlook during development?</span></div>
<img id="background" style="position:absolute; left:0px; top:74957px;" width="1440" height="1080" src="page64.png"> <img id="background" style="position:absolute; left:1440px; top:74957px;" width="1440" height="1080" src="page-000064.png">
<div class="txt" style="position:absolute; left:804px; top:74975px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:75064px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">CHECKLIST: Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:75204px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Exceptions</span></div>
<div class="txt" style="position:absolute; left:112px; top:75271px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Has your project defined a standardized approach to exception handling?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75331px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Have you considered alternatives to using an exception?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75392px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Is the error handled locally rather than throwing a non-local exception if</span></div>
<div class="txt" style="position:absolute; left:148px; top:75435px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">possible?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75495px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does the code avoid throwing exceptions in constructors and destructors?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75556px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Are all exceptions at the appropriate levels of abstraction for the routines</span></div>
<div class="txt" style="position:absolute; left:148px; top:75599px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">that throw them?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75660px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does each exception include all relevant exception background</span></div>
<div class="txt" style="position:absolute; left:148px; top:75703px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">information?</span></div>
<div class="txt" style="position:absolute; left:112px; top:75763px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Is the code free of empty catch blocks? (Or if an empty catch block truly is</span></div>
<div class="txt" style="position:absolute; left:148px; top:75806px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">appropriate, is it documented?)</span></div>
<img id="background" style="position:absolute; left:0px; top:76146px;" width="1440" height="1080" src="page65.png"> <img id="background" style="position:absolute; left:1440px; top:76146px;" width="1440" height="1080" src="page-000065.png">
<div class="txt" style="position:absolute; left:804px; top:76164px;"><span id="f8" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">7.3 Assertions and Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:33px; top:76253px;"><span id="f8" style="font-size:60px;vertical-align:baseline;color:rgba(0,0,0,1);">CHECKLIST: Defensive Programming</span></div>
<div class="txt" style="position:absolute; left:76px; top:76393px;"><span id="f11" style="font-size:40px;vertical-align:baseline;color:rgba(255,130,44,1);">▪ </span><span id="f13" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">Security Issues</span></div>
<div class="txt" style="position:absolute; left:112px; top:76460px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Does the code that checks for bad input data check for attempted buffer</span></div>
<div class="txt" style="position:absolute; left:148px; top:76503px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">overflows, SQL injection, html injection, integer overflows, and other</span></div>
<div class="txt" style="position:absolute; left:148px; top:76546px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">malicious inputs?</span></div>
<div class="txt" style="position:absolute; left:112px; top:76607px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Are all error-return codes checked?</span></div>
<div class="txt" style="position:absolute; left:112px; top:76667px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Are all exceptions caught?</span></div>
<div class="txt" style="position:absolute; left:112px; top:76728px;"><span id="f15" style="font-size:36px;vertical-align:baseline;color:rgba(255,130,44,1);">– </span><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">Do error messages avoid providing information that would help an</span></div>
<div class="txt" style="position:absolute; left:148px; top:76771px;"><span id="f8" style="font-size:36px;vertical-align:baseline;color:rgba(0,0,0,1);">attacker break into the system?</span></div>
<img id="background" style="position:absolute; left:0px; top:77335px;" width="1440" height="1080" src="page66.png"> <img id="background" style="position:absolute; left:1440px; top:77335px;" width="1440" height="1080" src="page-000066.png">
<div class="txt" style="position:absolute; left:1105px; top:77353px;"><span id="f9" style="font-size:31px;vertical-align:baseline;color:rgba(0,0,0,1);">Software Construction</span></div>
<div class="txt" style="position:absolute; left:590px; top:77750px;"><span id="f9" style="font-size:72px;vertical-align:baseline;color:rgba(0,0,0,1);">The end</span></div>
<div class="txt" style="position:absolute; left:614px; top:78004px;"><span id="f9" style="font-size:40px;vertical-align:baseline;color:rgba(0,0,0,1);">May 6, 2019</span></div>
</body></html>